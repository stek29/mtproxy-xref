<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>jobs.h source code [MTProxy/jobs/jobs.h] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="async_job,job_class,job_list_node,job_message,job_message_payload,job_message_queue,job_subclass,job_subclass_list,job_thread,job_timer_info,thread_callback "/>
<link rel="stylesheet" href="../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'MTProxy/jobs/jobs.h'; var root_path = '../..'; var data_path = '../../data';</script>
<script src='../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='..'>MTProxy</a>/<a href='./'>jobs</a>/<a href='jobs.h.html'>jobs.h</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i>    This file is part of Mtproto-proxy Library.</i></td></tr>
<tr><th id="3">3</th><td><i></i></td></tr>
<tr><th id="4">4</th><td><i>    Mtproto-proxy Library is free software: you can redistribute it and/or modify</i></td></tr>
<tr><th id="5">5</th><td><i>    it under the terms of the GNU Lesser General Public License as published by</i></td></tr>
<tr><th id="6">6</th><td><i>    the Free Software Foundation, either version 2 of the License, or</i></td></tr>
<tr><th id="7">7</th><td><i>    (at your option) any later version.</i></td></tr>
<tr><th id="8">8</th><td><i></i></td></tr>
<tr><th id="9">9</th><td><i>    Mtproto-proxy Library is distributed in the hope that it will be useful,</i></td></tr>
<tr><th id="10">10</th><td><i>    but WITHOUT ANY WARRANTY; without even the implied warranty of</i></td></tr>
<tr><th id="11">11</th><td><i>    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</i></td></tr>
<tr><th id="12">12</th><td><i>    GNU Lesser General Public License for more details.</i></td></tr>
<tr><th id="13">13</th><td><i></i></td></tr>
<tr><th id="14">14</th><td><i>    You should have received a copy of the GNU Lesser General Public License</i></td></tr>
<tr><th id="15">15</th><td><i>    along with Mtproto-proxy Library.  If not, see &lt;<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.</i></td></tr>
<tr><th id="16">16</th><td><i></i></td></tr>
<tr><th id="17">17</th><td><i>    Copyright 2014-2015 Telegram Messenger Inc</i></td></tr>
<tr><th id="18">18</th><td><i>              2014-2015 Nikolai Durov</i></td></tr>
<tr><th id="19">19</th><td><i>              2014      Andrey Lopatin</i></td></tr>
<tr><th id="20">20</th><td><i>*/</i></td></tr>
<tr><th id="21">21</th><td></td></tr>
<tr><th id="22">22</th><td><u>#pragma once</u></td></tr>
<tr><th id="23">23</th><td></td></tr>
<tr><th id="24">24</th><td><u>#include <a href="../../include/stdlib.h.html">&lt;stdlib.h&gt;</a></u></td></tr>
<tr><th id="25">25</th><td><u>#include <a href="../../include/string.h.html">&lt;string.h&gt;</a></u></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="../../include/semaphore.h.html">&lt;semaphore.h&gt;</a></u></td></tr>
<tr><th id="27">27</th><td><u>#include <a href="../net/net-events.h.html">"net/net-events.h"</a></u></td></tr>
<tr><th id="28">28</th><td><u>#include <a href="../net/net-msg.h.html">"net/net-msg.h"</a></u></td></tr>
<tr><th id="29">29</th><td><u>#include <a href="../net/net-timers.h.html">"net/net-timers.h"</a></u></td></tr>
<tr><th id="30">30</th><td></td></tr>
<tr><th id="31">31</th><td><u>#define <dfn class="macro" id="_M/__joblocked" data-ref="_M/__joblocked">__joblocked</dfn></u></td></tr>
<tr><th id="32">32</th><td><u>#define <dfn class="macro" id="_M/__jobref" data-ref="_M/__jobref">__jobref</dfn></u></td></tr>
<tr><th id="33">33</th><td></td></tr>
<tr><th id="34">34</th><td><u>#define <dfn class="macro" id="_M/MAX_SUBCLASS_THREADS" data-ref="_M/MAX_SUBCLASS_THREADS">MAX_SUBCLASS_THREADS</dfn> 16</u></td></tr>
<tr><th id="35">35</th><td></td></tr>
<tr><th id="36">36</th><td><i>//#include "net/net-connections.h"</i></td></tr>
<tr><th id="37">37</th><td><i></i></td></tr>
<tr><th id="38">38</th><td><i>// verbosity level for jobs</i></td></tr>
<tr><th id="39">39</th><td><u>#define <dfn class="macro" id="_M/JOBS_DEBUG" data-ref="_M/JOBS_DEBUG">JOBS_DEBUG</dfn> 3</u></td></tr>
<tr><th id="40">40</th><td></td></tr>
<tr><th id="41">41</th><td><u>#define <dfn class="macro" id="_M/CONCAT" data-ref="_M/CONCAT">CONCAT</dfn>(a,b) a ## b</u></td></tr>
<tr><th id="42">42</th><td></td></tr>
<tr><th id="43">43</th><td><u>#define <dfn class="macro" id="_M/PTR_MOVE" data-ref="_M/PTR_MOVE">PTR_MOVE</dfn>(__ptr_v) \</u></td></tr>
<tr><th id="44">44</th><td><u>  ({ typeof(__ptr_v) <dfn class="local col2 decl" id="1872__ptr_v_save" title='__ptr_v_save' data-type='typeof (job)' data-ref="1872__ptr_v_save"><dfn class="local col6 decl" id="1936__ptr_v_save" title='__ptr_v_save' data-type='typeof (job)' data-ref="1936__ptr_v_save"><dfn class="local col7 decl" id="1937__ptr_v_save" title='__ptr_v_save' data-type='typeof (src)' data-ref="1937__ptr_v_save"><dfn class="local col9 decl" id="1939__ptr_v_save" title='__ptr_v_save' data-type='typeof (M-&gt;src)' data-ref="1939__ptr_v_save"><dfn class="local col5 decl" id="1965__ptr_v_save" title='__ptr_v_save' data-type='typeof (job)' data-ref="1965__ptr_v_save">__ptr_v_save</dfn></dfn></dfn></dfn></dfn> = __ptr_v; __ptr_v = NULL; <a class="local col2 ref" href="#293" title='__ptr_v_save' data-ref="1872__ptr_v_save"><a class="local col6 ref" href="#372" title='__ptr_v_save' data-ref="1936__ptr_v_save"><a class="local col7 ref" href="#372" title='__ptr_v_save' data-ref="1937__ptr_v_save"><a class="local col9 ref" href="#378" title='__ptr_v_save' data-ref="1939__ptr_v_save"><a class="local col5 ref" href="#421" title='__ptr_v_save' data-ref="1965__ptr_v_save">__ptr_v_save</a></a></a></a></a>; })</u></td></tr>
<tr><th id="45">45</th><td></td></tr>
<tr><th id="46">46</th><td><u>#define <dfn class="macro" id="_M/JOB_REF_ARG" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</dfn>(__name) int __name ## _tag_int, <a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> __name</u></td></tr>
<tr><th id="47">47</th><td><u>#define <dfn class="macro" id="_M/JOB_REF_PASS" data-ref="_M/JOB_REF_PASS">JOB_REF_PASS</dfn>(__ptr) 1, PTR_MOVE (__ptr)</u></td></tr>
<tr><th id="48">48</th><td><u>#define <dfn class="macro" id="_M/JOB_REF_NULL" data-ref="_M/JOB_REF_NULL">JOB_REF_NULL</dfn> 1, NULL</u></td></tr>
<tr><th id="49">49</th><td><u>#define <dfn class="macro" id="_M/JOB_REF_CREATE_PASS" data-ref="_M/JOB_REF_CREATE_PASS">JOB_REF_CREATE_PASS</dfn>(__ptr) 1, job_incref (__ptr)</u></td></tr>
<tr><th id="50">50</th><td><u>#define <dfn class="macro" id="_M/JOB_REF_CREATE_PASS_N" data-ref="_M/JOB_REF_CREATE_PASS_N">JOB_REF_CREATE_PASS_N</dfn>(__ptr) 1, __ptr ? job_incref (__ptr) : NULL</u></td></tr>
<tr><th id="51">51</th><td></td></tr>
<tr><th id="52">52</th><td><b>struct</b> <a class="type" href="#job_thread" title='job_thread' data-ref="job_thread">job_thread</a>;</td></tr>
<tr><th id="53">53</th><td><b>struct</b> <a class="type" href="#async_job" title='async_job' data-ref="async_job">async_job</a>;</td></tr>
<tr><th id="54">54</th><td><b>typedef</b> <b>struct</b> <a class="type" href="#async_job" title='async_job' data-ref="async_job">async_job</a> *<dfn class="typedef" id="job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</dfn>;</td></tr>
<tr><th id="55">55</th><td></td></tr>
<tr><th id="56">56</th><td><b>typedef</b> <em>int</em> (*<dfn class="typedef" id="job_function_t" title='job_function_t' data-type='int (*)(job_t, int, struct job_thread *)' data-ref="job_function_t">job_function_t</dfn>)(<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col4 decl" id="1834job" title='job' data-type='job_t' data-ref="1834job">job</dfn>, <em>int</em> <dfn class="local col5 decl" id="1835op" title='op' data-type='int' data-ref="1835op">op</dfn>, <b>struct</b> <a class="type" href="#job_thread" title='job_thread' data-ref="job_thread">job_thread</a> *<dfn class="local col6 decl" id="1836JT" title='JT' data-type='struct job_thread *' data-ref="1836JT">JT</dfn>);</td></tr>
<tr><th id="57">57</th><td></td></tr>
<tr><th id="58">58</th><td><b>extern</b> <b>__thread</b> <b>struct</b> <a class="type" href="#job_thread" title='job_thread' data-ref="job_thread">job_thread</a> *<dfn class="decl" id="this_job_thread" title='this_job_thread' data-ref="this_job_thread">this_job_thread</dfn>;</td></tr>
<tr><th id="59">59</th><td><b>extern</b> <b>__thread</b> <a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="decl" id="this_job" title='this_job' data-ref="this_job">this_job</dfn>;</td></tr>
<tr><th id="60">60</th><td></td></tr>
<tr><th id="61">61</th><td><u>#define <dfn class="macro" id="_M/JOB_DESTROYED" data-ref="_M/JOB_DESTROYED">JOB_DESTROYED</dfn>	-0x80000000</u></td></tr>
<tr><th id="62">62</th><td><u>#define	<dfn class="macro" id="_M/JOB_COMPLETED" data-ref="_M/JOB_COMPLETED">JOB_COMPLETED</dfn>	0x100</u></td></tr>
<tr><th id="63">63</th><td><u>#define <dfn class="macro" id="_M/JOB_FINISH" data-ref="_M/JOB_FINISH">JOB_FINISH</dfn>	0x80</u></td></tr>
<tr><th id="64">64</th><td><u>#define <dfn class="macro" id="_M/JOB_ERROR" data-ref="_M/JOB_ERROR">JOB_ERROR</dfn>	-1</u></td></tr>
<tr><th id="65">65</th><td></td></tr>
<tr><th id="66">66</th><td><i>/* job signal numbers (0..7) */</i></td></tr>
<tr><th id="67">67</th><td><u>#define	<dfn class="macro" id="_M/JS_FREE" data-ref="_M/JS_FREE">JS_FREE</dfn>	-1		/* pseudo-signal, invoked to free job structure ("destructor") */</u></td></tr>
<tr><th id="68">68</th><td><u>#define <dfn class="macro" id="_M/JS_RUN" data-ref="_M/JS_RUN">JS_RUN</dfn>	0</u></td></tr>
<tr><th id="69">69</th><td><u>#define <dfn class="macro" id="_M/JS_AUX" data-ref="_M/JS_AUX">JS_AUX</dfn>	1</u></td></tr>
<tr><th id="70">70</th><td><u>#define <dfn class="macro" id="_M/JS_MSG" data-ref="_M/JS_MSG">JS_MSG</dfn> 2</u></td></tr>
<tr><th id="71">71</th><td><u>#define	<dfn class="macro" id="_M/JS_ALARM" data-ref="_M/JS_ALARM">JS_ALARM</dfn>	4	/* usually sent by timer */</u></td></tr>
<tr><th id="72">72</th><td><u>#define	<dfn class="macro" id="_M/JS_ABORT" data-ref="_M/JS_ABORT">JS_ABORT</dfn>	5	/* used for error propagation, especially from children */</u></td></tr>
<tr><th id="73">73</th><td><u>#define	<dfn class="macro" id="_M/JS_KILL" data-ref="_M/JS_KILL">JS_KILL</dfn>	6</u></td></tr>
<tr><th id="74">74</th><td><u>#define	<dfn class="macro" id="_M/JS_FINISH" data-ref="_M/JS_FINISH">JS_FINISH</dfn>	7</u></td></tr>
<tr><th id="75">75</th><td><u>#define	<dfn class="macro" id="_M/JS_SIG0" data-ref="_M/JS_SIG0">JS_SIG0</dfn>	0</u></td></tr>
<tr><th id="76">76</th><td><u>#define	<dfn class="macro" id="_M/JS_SIG1" data-ref="_M/JS_SIG1">JS_SIG1</dfn>	1</u></td></tr>
<tr><th id="77">77</th><td><u>#define	<dfn class="macro" id="_M/JS_SIG2" data-ref="_M/JS_SIG2">JS_SIG2</dfn>	2</u></td></tr>
<tr><th id="78">78</th><td><u>#define	<dfn class="macro" id="_M/JS_SIG3" data-ref="_M/JS_SIG3">JS_SIG3</dfn>	3</u></td></tr>
<tr><th id="79">79</th><td><u>#define	<dfn class="macro" id="_M/JS_SIG4" data-ref="_M/JS_SIG4">JS_SIG4</dfn>	4</u></td></tr>
<tr><th id="80">80</th><td><u>#define	<dfn class="macro" id="_M/JS_SIG5" data-ref="_M/JS_SIG5">JS_SIG5</dfn>	5</u></td></tr>
<tr><th id="81">81</th><td><u>#define	<dfn class="macro" id="_M/JS_SIG6" data-ref="_M/JS_SIG6">JS_SIG6</dfn>	6</u></td></tr>
<tr><th id="82">82</th><td><u>#define	<dfn class="macro" id="_M/JS_SIG7" data-ref="_M/JS_SIG7">JS_SIG7</dfn>	7</u></td></tr>
<tr><th id="83">83</th><td></td></tr>
<tr><th id="84">84</th><td><b>extern</b> <em>int</em> <dfn class="decl" id="engine_multithread_mode" title='engine_multithread_mode' data-ref="engine_multithread_mode">engine_multithread_mode</dfn>;</td></tr>
<tr><th id="85">85</th><td></td></tr>
<tr><th id="86">86</th><td><u>#define <dfn class="macro" id="_M/JC_EPOLL" data-ref="_M/JC_EPOLL">JC_EPOLL</dfn> JC_MAIN</u></td></tr>
<tr><th id="87">87</th><td><u>#define <dfn class="macro" id="_M/JC_METAFILE_READ" data-ref="_M/JC_METAFILE_READ">JC_METAFILE_READ</dfn> JC_IO</u></td></tr>
<tr><th id="88">88</th><td><u>#define <dfn class="macro" id="_M/JC_METAFILE_PREPARE" data-ref="_M/JC_METAFILE_PREPARE">JC_METAFILE_PREPARE</dfn> JC_CPU</u></td></tr>
<tr><th id="89">89</th><td><u>#define <dfn class="macro" id="_M/JC_CONNECTION" data-ref="_M/JC_CONNECTION">JC_CONNECTION</dfn> 4</u></td></tr>
<tr><th id="90">90</th><td><u>#define <dfn class="macro" id="_M/JC_CONNECTION_IO" data-ref="_M/JC_CONNECTION_IO">JC_CONNECTION_IO</dfn> 5</u></td></tr>
<tr><th id="91">91</th><td><u>#define <dfn class="macro" id="_M/JC_UDP" data-ref="_M/JC_UDP">JC_UDP</dfn> 6</u></td></tr>
<tr><th id="92">92</th><td><u>#define <dfn class="macro" id="_M/JC_UDP_IO" data-ref="_M/JC_UDP_IO">JC_UDP_IO</dfn> 7</u></td></tr>
<tr><th id="93">93</th><td><u>#define <dfn class="macro" id="_M/JC_ENGINE" data-ref="_M/JC_ENGINE">JC_ENGINE</dfn> 8</u></td></tr>
<tr><th id="94">94</th><td><u>#define <dfn class="macro" id="_M/JC_GMS" data-ref="_M/JC_GMS">JC_GMS</dfn> JC_ENGINE</u></td></tr>
<tr><th id="95">95</th><td><u>#define <dfn class="macro" id="_M/JC_GMS_CPU" data-ref="_M/JC_GMS_CPU">JC_GMS_CPU</dfn> 10</u></td></tr>
<tr><th id="96">96</th><td><u>#define <dfn class="macro" id="_M/JC_ENGINE_MULT" data-ref="_M/JC_ENGINE_MULT">JC_ENGINE_MULT</dfn> 11</u></td></tr>
<tr><th id="97">97</th><td></td></tr>
<tr><th id="98">98</th><td></td></tr>
<tr><th id="99">99</th><td><u>#define <dfn class="macro" id="_M/DEFAULT_IO_JOB_THREADS" data-ref="_M/DEFAULT_IO_JOB_THREADS">DEFAULT_IO_JOB_THREADS</dfn>	16</u></td></tr>
<tr><th id="100">100</th><td><u>#define <dfn class="macro" id="_M/DEFAULT_CPU_JOB_THREADS" data-ref="_M/DEFAULT_CPU_JOB_THREADS">DEFAULT_CPU_JOB_THREADS</dfn>	8</u></td></tr>
<tr><th id="101">101</th><td><u>#define <dfn class="macro" id="_M/DEFAULT_GMS_CPU_JOB_THREADS" data-ref="_M/DEFAULT_GMS_CPU_JOB_THREADS">DEFAULT_GMS_CPU_JOB_THREADS</dfn> 8</u></td></tr>
<tr><th id="102">102</th><td></td></tr>
<tr><th id="103">103</th><td><i>// fake class</i></td></tr>
<tr><th id="104">104</th><td><i>// no signals should be allowed</i></td></tr>
<tr><th id="105">105</th><td><u>#define <dfn class="macro" id="_M/JC_MP_QUEUE" data-ref="_M/JC_MP_QUEUE">JC_MP_QUEUE</dfn> 9</u></td></tr>
<tr><th id="106">106</th><td></td></tr>
<tr><th id="107">107</th><td></td></tr>
<tr><th id="108">108</th><td><u>#define <dfn class="macro" id="_M/JC_NONE" data-ref="_M/JC_NONE">JC_NONE</dfn>	0	// no signal (unless used with "fast" flag; then it means "any context")</u></td></tr>
<tr><th id="109">109</th><td><u>#define <dfn class="macro" id="_M/JC_IO" data-ref="_M/JC_IO">JC_IO</dfn>	1	// signal must be processed in I/O thread</u></td></tr>
<tr><th id="110">110</th><td><u>#define <dfn class="macro" id="_M/JC_CPU" data-ref="_M/JC_CPU">JC_CPU</dfn>	2	// signal must be processed in CPU thread</u></td></tr>
<tr><th id="111">111</th><td><u>#define <dfn class="macro" id="_M/JC_MAIN" data-ref="_M/JC_MAIN">JC_MAIN</dfn>	3	// signal must be processed in main thread (unless specified otherwise)</u></td></tr>
<tr><th id="112">112</th><td><u>#define <dfn class="macro" id="_M/JC_MAX" data-ref="_M/JC_MAX">JC_MAX</dfn>	0xf</u></td></tr>
<tr><th id="113">113</th><td><u>#define <dfn class="macro" id="_M/JC_MASK" data-ref="_M/JC_MASK">JC_MASK</dfn>	JC_MAX</u></td></tr>
<tr><th id="114">114</th><td></td></tr>
<tr><th id="115">115</th><td><u>#define	<dfn class="macro" id="_M/JF_LOCKED" data-ref="_M/JF_LOCKED">JF_LOCKED</dfn>	0x10000	// job is "locked" (usually this means that a signal is being processed)</u></td></tr>
<tr><th id="116">116</th><td><u>#define	<dfn class="macro" id="_M/JF_SIGINT" data-ref="_M/JF_SIGINT">JF_SIGINT</dfn>	0x20000	// signal interruption: if job is "locked" and we send a new signal to it, invoke pthread_signal() as well</u></td></tr>
<tr><th id="117">117</th><td><u>#define <dfn class="macro" id="_M/JF_COMPLETED" data-ref="_M/JF_COMPLETED">JF_COMPLETED</dfn>	0x40000	// used to signal job "completion" to outside observers</u></td></tr>
<tr><th id="118">118</th><td></td></tr>
<tr><th id="119">119</th><td><u>#define <dfn class="macro" id="_M/JF_QUEUED_CLASS" data-ref="_M/JF_QUEUED_CLASS">JF_QUEUED_CLASS</dfn>(__c)	(1 &lt;&lt; (__c))</u></td></tr>
<tr><th id="120">120</th><td><u>#define	<dfn class="macro" id="_M/JF_QUEUED_MAIN" data-ref="_M/JF_QUEUED_MAIN">JF_QUEUED_MAIN</dfn>	JF_QUEUED_CLASS(JC_MAIN)	// job is in MAIN execution queue</u></td></tr>
<tr><th id="121">121</th><td><u>#define	<dfn class="macro" id="_M/JF_QUEUED_IO" data-ref="_M/JF_QUEUED_IO">JF_QUEUED_IO</dfn>	JF_QUEUED_CLASS(JC_IO)		// job is in IO execution queue</u></td></tr>
<tr><th id="122">122</th><td><u>#define	<dfn class="macro" id="_M/JF_QUEUED_CPU" data-ref="_M/JF_QUEUED_CPU">JF_QUEUED_CPU</dfn>	JF_QUEUED_CLASS(JC_CPU)		// job is in CPU execution queue</u></td></tr>
<tr><th id="123">123</th><td><u>#define	<dfn class="macro" id="_M/JF_QUEUED" data-ref="_M/JF_QUEUED">JF_QUEUED</dfn>	0xffff	// job is in some execution queue</u></td></tr>
<tr><th id="124">124</th><td></td></tr>
<tr><th id="125">125</th><td><u>#define <dfn class="macro" id="_M/JT_HAVE_TIMER" data-ref="_M/JT_HAVE_TIMER">JT_HAVE_TIMER</dfn> 1</u></td></tr>
<tr><th id="126">126</th><td><u>#define <dfn class="macro" id="_M/JT_HAVE_MSG_QUEUE" data-ref="_M/JT_HAVE_MSG_QUEUE">JT_HAVE_MSG_QUEUE</dfn> 2</u></td></tr>
<tr><th id="127">127</th><td></td></tr>
<tr><th id="128">128</th><td><u>#define	<dfn class="macro" id="_M/JFS_SET" data-ref="_M/JFS_SET">JFS_SET</dfn>(__s)	(0x1000000U &lt;&lt; (__s))	// j_flags: signal __s is awaiting delivery</u></td></tr>
<tr><th id="129">129</th><td><u>#define	<dfn class="macro" id="_M/JSS_ALLOW" data-ref="_M/JSS_ALLOW">JSS_ALLOW</dfn>(__s)	(0x1000000U &lt;&lt; (__s))	// j_status: signal __s is allowed for delivery</u></td></tr>
<tr><th id="130">130</th><td><u>#define	<dfn class="macro" id="_M/JSS_FAST" data-ref="_M/JSS_FAST">JSS_FAST</dfn>(__s)	(0x10000U &lt;&lt; (__s))	// j_status: signal __s is "fast" -- may be processed recursively in specified or in any context, not necessarily in order</u></td></tr>
<tr><th id="131">131</th><td><u>#define	<dfn class="macro" id="_M/JSS_ALLOW_FAST" data-ref="_M/JSS_ALLOW_FAST">JSS_ALLOW_FAST</dfn>(__s)	(0x1010000U &lt;&lt; (__s))</u></td></tr>
<tr><th id="132">132</th><td></td></tr>
<tr><th id="133">133</th><td></td></tr>
<tr><th id="134">134</th><td><u>#define <dfn class="macro" id="_M/JOB_SENDSIG" data-ref="_M/JOB_SENDSIG">JOB_SENDSIG</dfn>(__s)	(1 &lt;&lt; (__s))</u></td></tr>
<tr><th id="135">135</th><td></td></tr>
<tr><th id="136">136</th><td><u>#define <dfn class="macro" id="_M/JSC_TYPE" data-ref="_M/JSC_TYPE">JSC_TYPE</dfn>(__c,__s)	(((unsigned long long)(__c) &lt;&lt; ((__s) * 4 + 32)))</u></td></tr>
<tr><th id="137">137</th><td><u>#define <dfn class="macro" id="_M/JSC_ALLOW" data-ref="_M/JSC_ALLOW">JSC_ALLOW</dfn>(__c,__s)	(JSC_TYPE(__c,__s) | JSS_ALLOW(__s))</u></td></tr>
<tr><th id="138">138</th><td><u>#define <dfn class="macro" id="_M/JSC_FAST" data-ref="_M/JSC_FAST">JSC_FAST</dfn>(__c,__s)	(JSC_TYPE(__c,__s) | JSS_ALLOW_FAST(__s))</u></td></tr>
<tr><th id="139">139</th><td><u>#define <dfn class="macro" id="_M/JSIG_MAIN" data-ref="_M/JSIG_MAIN">JSIG_MAIN</dfn>(__s)	JSC_ALLOW(JC_MAIN,__s)</u></td></tr>
<tr><th id="140">140</th><td><u>#define <dfn class="macro" id="_M/JSIG_IO" data-ref="_M/JSIG_IO">JSIG_IO</dfn>(__s)	JSC_ALLOW(JC_IO,__s)</u></td></tr>
<tr><th id="141">141</th><td><u>#define <dfn class="macro" id="_M/JSIG_CPU" data-ref="_M/JSIG_CPU">JSIG_CPU</dfn>(__s)	JSC_ALLOW(JC_CPU,__s)</u></td></tr>
<tr><th id="142">142</th><td><u>#define <dfn class="macro" id="_M/JSIG_FAST" data-ref="_M/JSIG_FAST">JSIG_FAST</dfn>(__s)	JSC_FAST(JC_NONE,__s)</u></td></tr>
<tr><th id="143">143</th><td><u>#define <dfn class="macro" id="_M/JSIG_ENGINE" data-ref="_M/JSIG_ENGINE">JSIG_ENGINE</dfn>(__s)	JSC_ALLOW(JC_ENGINE,__s)</u></td></tr>
<tr><th id="144">144</th><td></td></tr>
<tr><th id="145">145</th><td><u>#define	<dfn class="macro" id="_M/JSP_PARENT_ERROR" data-ref="_M/JSP_PARENT_ERROR">JSP_PARENT_ERROR</dfn>	1		// j_status: propagate error to j_error field in j_parent, and send ABORT to parent</u></td></tr>
<tr><th id="146">146</th><td><u>#define	<dfn class="macro" id="_M/JSP_PARENT_RUN" data-ref="_M/JSP_PARENT_RUN">JSP_PARENT_RUN</dfn>		2		// j_status: send RUN to j_parent after job completion</u></td></tr>
<tr><th id="147">147</th><td><u>#define	<dfn class="macro" id="_M/JSP_PARENT_WAKEUP" data-ref="_M/JSP_PARENT_WAKEUP">JSP_PARENT_WAKEUP</dfn>	4		// j_status: decrease j_parent's j_children; if it becomes 0, maybe send RUN</u></td></tr>
<tr><th id="148">148</th><td><u>#define	<dfn class="macro" id="_M/JSP_PARENT_RESPTR" data-ref="_M/JSP_PARENT_RESPTR">JSP_PARENT_RESPTR</dfn>	8		// j_status: (result) pointer(s) kept in j_custom actually point inside j_parent; use them only if j_parent is still valid</u></td></tr>
<tr><th id="149">149</th><td><u>#define <dfn class="macro" id="_M/JSP_PARENT_INCOMPLETE" data-ref="_M/JSP_PARENT_INCOMPLETE">JSP_PARENT_INCOMPLETE</dfn>	0x10		// abort job if parent already completed</u></td></tr>
<tr><th id="150">150</th><td><u>#define	<dfn class="macro" id="_M/JSP_PARENT_RWE" data-ref="_M/JSP_PARENT_RWE">JSP_PARENT_RWE</dfn>	7</u></td></tr>
<tr><th id="151">151</th><td><u>#define	<dfn class="macro" id="_M/JSP_PARENT_RWEP" data-ref="_M/JSP_PARENT_RWEP">JSP_PARENT_RWEP</dfn>	0xf</u></td></tr>
<tr><th id="152">152</th><td><u>#define	<dfn class="macro" id="_M/JSP_PARENT_RWEI" data-ref="_M/JSP_PARENT_RWEI">JSP_PARENT_RWEI</dfn>	0x17</u></td></tr>
<tr><th id="153">153</th><td><u>#define	<dfn class="macro" id="_M/JSP_PARENT_RWEPI" data-ref="_M/JSP_PARENT_RWEPI">JSP_PARENT_RWEPI</dfn>	0x1f</u></td></tr>
<tr><th id="154">154</th><td></td></tr>
<tr><th id="155">155</th><td><u>#define <dfn class="macro" id="_M/JMC_UPDATE" data-ref="_M/JMC_UPDATE">JMC_UPDATE</dfn> 1</u></td></tr>
<tr><th id="156">156</th><td><u>#define <dfn class="macro" id="_M/JMC_FORCE_UPDATE" data-ref="_M/JMC_FORCE_UPDATE">JMC_FORCE_UPDATE</dfn> 2</u></td></tr>
<tr><th id="157">157</th><td><u>#define <dfn class="macro" id="_M/JMC_RPC_QUERY" data-ref="_M/JMC_RPC_QUERY">JMC_RPC_QUERY</dfn> 3</u></td></tr>
<tr><th id="158">158</th><td><u>#define <dfn class="macro" id="_M/JMC_TYPE_MASK" data-ref="_M/JMC_TYPE_MASK">JMC_TYPE_MASK</dfn> 31</u></td></tr>
<tr><th id="159">159</th><td></td></tr>
<tr><th id="160">160</th><td><u>#define <dfn class="macro" id="_M/JMC_CONTINUATION" data-ref="_M/JMC_CONTINUATION">JMC_CONTINUATION</dfn> 8</u></td></tr>
<tr><th id="161">161</th><td></td></tr>
<tr><th id="162">162</th><td><u>#define <dfn class="macro" id="_M/JMC_EXTRACT_ANSWER" data-ref="_M/JMC_EXTRACT_ANSWER">JMC_EXTRACT_ANSWER</dfn>(__type) (((__type) &gt;&gt; 8) &amp; 255)</u></td></tr>
<tr><th id="163">163</th><td><u>#define <dfn class="macro" id="_M/JMC_ANSWER" data-ref="_M/JMC_ANSWER">JMC_ANSWER</dfn>(__type) ((__type) &lt;&lt; 8)</u></td></tr>
<tr><th id="164">164</th><td></td></tr>
<tr><th id="165">165</th><td><i>/* all fields here, with the exception of bits 24..31 and JF_LOCKED of j_flags, j_error, j_refcnt, j_children, may be changed only</i></td></tr>
<tr><th id="166">166</th><td><i>   by somebody who already owns a lock to this job, or has the only pointer to it. */</i></td></tr>
<tr><th id="167">167</th><td><b>struct</b> <dfn class="type def" id="async_job" title='async_job' data-ref="async_job">async_job</dfn> {  <i>// must be partially compatible with `struct connection`</i></td></tr>
<tr><th id="168">168</th><td>  <em>int</em> <dfn class="decl" id="async_job::j_flags" title='async_job::j_flags' data-ref="async_job::j_flags">j_flags</dfn>;  <i>// bits 0..15: queue flags; bits 16..23: status; bits 24..31: received signals (only bits that can be changed without having lock)</i></td></tr>
<tr><th id="169">169</th><td>  <em>int</em> <dfn class="decl" id="async_job::j_status" title='async_job::j_status' data-ref="async_job::j_status">j_status</dfn>;	<i>// bits 24..31: allowed signals; bits 16..23: corresponding signal is "fast"; bits 0..4: relation to parent</i></td></tr>
<tr><th id="170">170</th><td>  <em>int</em> <dfn class="decl" id="async_job::j_sigclass" title='async_job::j_sigclass' data-ref="async_job::j_sigclass">j_sigclass</dfn>;  <i>// bits (4*n)..(4*n-3): queue class of signal n, n=0..7</i></td></tr>
<tr><th id="171">171</th><td>  <em>int</em> <dfn class="decl" id="async_job::j_refcnt" title='async_job::j_refcnt' data-ref="async_job::j_refcnt">j_refcnt</dfn>;	<i>// reference counter, changed by job_incref() and job_decref(); when becomes zero, j_execute is invoked with op = JS_FREE</i></td></tr>
<tr><th id="172">172</th><td>  <em>int</em> <dfn class="decl" id="async_job::j_error" title='async_job::j_error' data-ref="async_job::j_error">j_error</dfn>;  <i>// if non-zero, error code; may be overwritten by children (unless already non-zero: remembers first error only)</i></td></tr>
<tr><th id="173">173</th><td>  <em>int</em> <dfn class="decl" id="async_job::j_children" title='async_job::j_children' data-ref="async_job::j_children">j_children</dfn>;   <i>// number of jobs to complete before scheduling this job</i></td></tr>
<tr><th id="174">174</th><td>  <em>int</em> <dfn class="decl" id="async_job::j_align" title='async_job::j_align' data-ref="async_job::j_align">j_align</dfn>;  <i>// align of real allocated pointer</i></td></tr>
<tr><th id="175">175</th><td>  <em>int</em> <dfn class="decl" id="async_job::j_custom_bytes" title='async_job::j_custom_bytes' data-ref="async_job::j_custom_bytes">j_custom_bytes</dfn>;</td></tr>
<tr><th id="176">176</th><td></td></tr>
<tr><th id="177">177</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl" id="async_job::j_type" title='async_job::j_type' data-ref="async_job::j_type">j_type</dfn>; <i>// Bit 0 - have event_timer (must be first bytes of j_custom)</i></td></tr>
<tr><th id="178">178</th><td>                       <i>// Bit 1 - have message queue (must be after event_timer or first, if there is no event_timer)</i></td></tr>
<tr><th id="179">179</th><td>  <em>int</em> <dfn class="decl" id="async_job::j_subclass" title='async_job::j_subclass' data-ref="async_job::j_subclass">j_subclass</dfn>;</td></tr>
<tr><th id="180">180</th><td></td></tr>
<tr><th id="181">181</th><td>  <b>struct</b> <a class="type" href="#job_thread" title='job_thread' data-ref="job_thread">job_thread</a> *<dfn class="decl" id="async_job::j_thread" title='async_job::j_thread' data-ref="async_job::j_thread">j_thread</dfn>;  <i>// thread currently processing this job</i></td></tr>
<tr><th id="182">182</th><td>  <i>// maybe: reference to queue, position in queue -- if j_flags &amp; JF_QUEUED -- to remove from queue if necessary</i></td></tr>
<tr><th id="183">183</th><td>  <a class="typedef" href="#job_function_t" title='job_function_t' data-type='int (*)(job_t, int, struct job_thread *)' data-ref="job_function_t">job_function_t</a> <dfn class="decl" id="async_job::j_execute" title='async_job::j_execute' data-ref="async_job::j_execute">j_execute</dfn>;	<i>// invoked in correct context to process signals</i></td></tr>
<tr><th id="184">184</th><td>  <a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="decl" id="async_job::j_parent" title='async_job::j_parent' data-ref="async_job::j_parent">j_parent</dfn>;   <i>// parent (dependent) job or 0</i></td></tr>
<tr><th id="185">185</th><td>  <em>long</em> <em>long</em> <dfn class="decl" id="async_job::j_custom" title='async_job::j_custom' data-ref="async_job::j_custom">j_custom</dfn>[<var>0</var>] <b>__attribute__</b>((aligned(<var>64</var>)));</td></tr>
<tr><th id="186">186</th><td>} <b>__attribute__</b>((aligned(<var>64</var>)));</td></tr>
<tr><th id="187">187</th><td></td></tr>
<tr><th id="188">188</th><td><b>struct</b> <dfn class="type def" id="job_subclass" title='job_subclass' data-ref="job_subclass">job_subclass</dfn> {</td></tr>
<tr><th id="189">189</th><td>  <em>int</em> <dfn class="decl" id="job_subclass::subclass_id" title='job_subclass::subclass_id' data-ref="job_subclass::subclass_id">subclass_id</dfn>;</td></tr>
<tr><th id="190">190</th><td></td></tr>
<tr><th id="191">191</th><td>  <em>int</em> <dfn class="decl" id="job_subclass::total_jobs" title='job_subclass::total_jobs' data-ref="job_subclass::total_jobs">total_jobs</dfn>;</td></tr>
<tr><th id="192">192</th><td>  <em>int</em> <dfn class="decl" id="job_subclass::allowed_to_run_jobs" title='job_subclass::allowed_to_run_jobs' data-ref="job_subclass::allowed_to_run_jobs">allowed_to_run_jobs</dfn>;</td></tr>
<tr><th id="193">193</th><td>  <em>int</em> <dfn class="decl" id="job_subclass::processed_jobs" title='job_subclass::processed_jobs' data-ref="job_subclass::processed_jobs">processed_jobs</dfn>;</td></tr>
<tr><th id="194">194</th><td></td></tr>
<tr><th id="195">195</th><td>  <em>int</em> <dfn class="decl" id="job_subclass::locked" title='job_subclass::locked' data-ref="job_subclass::locked">locked</dfn>;</td></tr>
<tr><th id="196">196</th><td></td></tr>
<tr><th id="197">197</th><td>  <b>struct</b> <a class="type" href="../common/mp-queue.h.html#mp_queue" title='mp_queue' data-ref="mp_queue">mp_queue</a> *<dfn class="decl" id="job_subclass::job_queue" title='job_subclass::job_queue' data-ref="job_subclass::job_queue">job_queue</dfn>;</td></tr>
<tr><th id="198">198</th><td>};</td></tr>
<tr><th id="199">199</th><td></td></tr>
<tr><th id="200">200</th><td><b>struct</b> <dfn class="type def" id="job_subclass_list" title='job_subclass_list' data-ref="job_subclass_list">job_subclass_list</dfn> {</td></tr>
<tr><th id="201">201</th><td>  <em>int</em> <dfn class="decl" id="job_subclass_list::subclass_cnt" title='job_subclass_list::subclass_cnt' data-ref="job_subclass_list::subclass_cnt">subclass_cnt</dfn>;</td></tr>
<tr><th id="202">202</th><td></td></tr>
<tr><th id="203">203</th><td>  <a class="typedef" href="../../include/x86_64-linux-gnu/bits/semaphore.h.html#sem_t" title='sem_t' data-type='union sem_t' data-ref="sem_t">sem_t</a> <dfn class="decl" id="job_subclass_list::sem" title='job_subclass_list::sem' data-ref="job_subclass_list::sem">sem</dfn>;</td></tr>
<tr><th id="204">204</th><td></td></tr>
<tr><th id="205">205</th><td>  <b>struct</b> <a class="type" href="#job_subclass" title='job_subclass' data-ref="job_subclass">job_subclass</a> *<dfn class="decl" id="job_subclass_list::subclasses" title='job_subclass_list::subclasses' data-ref="job_subclass_list::subclasses">subclasses</dfn>;</td></tr>
<tr><th id="206">206</th><td>};</td></tr>
<tr><th id="207">207</th><td></td></tr>
<tr><th id="208">208</th><td><b>struct</b> <dfn class="type def" id="job_class" title='job_class' data-ref="job_class">job_class</dfn> {</td></tr>
<tr><th id="209">209</th><td>  <em>int</em> <dfn class="decl" id="job_class::thread_class" title='job_class::thread_class' data-ref="job_class::thread_class">thread_class</dfn>;</td></tr>
<tr><th id="210">210</th><td></td></tr>
<tr><th id="211">211</th><td>  <em>int</em> <dfn class="decl" id="job_class::min_threads" title='job_class::min_threads' data-ref="job_class::min_threads">min_threads</dfn>;</td></tr>
<tr><th id="212">212</th><td>  <em>int</em> <dfn class="decl" id="job_class::max_threads" title='job_class::max_threads' data-ref="job_class::max_threads">max_threads</dfn>;</td></tr>
<tr><th id="213">213</th><td>  <em>int</em> <dfn class="decl" id="job_class::cur_threads" title='job_class::cur_threads' data-ref="job_class::cur_threads">cur_threads</dfn>;</td></tr>
<tr><th id="214">214</th><td></td></tr>
<tr><th id="215">215</th><td>  <b>struct</b> <a class="type" href="../common/mp-queue.h.html#mp_queue" title='mp_queue' data-ref="mp_queue">mp_queue</a> *<dfn class="decl" id="job_class::job_queue" title='job_class::job_queue' data-ref="job_class::job_queue">job_queue</dfn>;</td></tr>
<tr><th id="216">216</th><td></td></tr>
<tr><th id="217">217</th><td>  <b>struct</b> <a class="type" href="#job_subclass_list" title='job_subclass_list' data-ref="job_subclass_list">job_subclass_list</a> *<dfn class="decl" id="job_class::subclasses" title='job_class::subclasses' data-ref="job_class::subclasses">subclasses</dfn>;</td></tr>
<tr><th id="218">218</th><td>};</td></tr>
<tr><th id="219">219</th><td></td></tr>
<tr><th id="220">220</th><td><b>struct</b> <dfn class="type def" id="job_thread" title='job_thread' data-ref="job_thread">job_thread</dfn> {</td></tr>
<tr><th id="221">221</th><td>  <a class="typedef" href="../../include/x86_64-linux-gnu/bits/pthreadtypes.h.html#pthread_t" title='pthread_t' data-type='unsigned long' data-ref="pthread_t">pthread_t</a> <dfn class="decl" id="job_thread::pthread_id" title='job_thread::pthread_id' data-ref="job_thread::pthread_id">pthread_id</dfn>;</td></tr>
<tr><th id="222">222</th><td>  <em>int</em> <dfn class="decl" id="job_thread::id" title='job_thread::id' data-ref="job_thread::id">id</dfn>;</td></tr>
<tr><th id="223">223</th><td>  <em>int</em> <dfn class="decl" id="job_thread::thread_class" title='job_thread::thread_class' data-ref="job_thread::thread_class">thread_class</dfn>; </td></tr>
<tr><th id="224">224</th><td>  <em>int</em> <dfn class="decl" id="job_thread::job_class_mask" title='job_thread::job_class_mask' data-ref="job_thread::job_class_mask">job_class_mask</dfn>;  <i>// job classes allowed to run in this thread</i></td></tr>
<tr><th id="225">225</th><td>  <em>int</em> <dfn class="decl" id="job_thread::status" title='job_thread::status' data-ref="job_thread::status">status</dfn>;  <i>// 0 = absent; +1 = created, +2 = running/waiting, +4 = performing job</i></td></tr>
<tr><th id="226">226</th><td>  <em>long</em> <em>long</em> <dfn class="decl" id="job_thread::jobs_performed" title='job_thread::jobs_performed' data-ref="job_thread::jobs_performed">jobs_performed</dfn>;</td></tr>
<tr><th id="227">227</th><td>  <b>struct</b> <a class="type" href="../common/mp-queue.h.html#mp_queue" title='mp_queue' data-ref="mp_queue">mp_queue</a> *<dfn class="decl" id="job_thread::job_queue" title='job_thread::job_queue' data-ref="job_thread::job_queue">job_queue</dfn>;</td></tr>
<tr><th id="228">228</th><td>  <b>struct</b> <a class="type" href="#async_job" title='async_job' data-ref="async_job">async_job</a> *<dfn class="decl" id="job_thread::current_job" title='job_thread::current_job' data-ref="job_thread::current_job">current_job</dfn>;  <i>// job currently performed or 0 (for DEBUG only)</i></td></tr>
<tr><th id="229">229</th><td>  <em>double</em> <dfn class="decl" id="job_thread::current_job_start_time" title='job_thread::current_job_start_time' data-ref="job_thread::current_job_start_time">current_job_start_time</dfn>, <dfn class="decl" id="job_thread::last_job_time" title='job_thread::last_job_time' data-ref="job_thread::last_job_time">last_job_time</dfn>, <dfn class="decl" id="job_thread::tot_jobs_time" title='job_thread::tot_jobs_time' data-ref="job_thread::tot_jobs_time">tot_jobs_time</dfn>;</td></tr>
<tr><th id="230">230</th><td>  <em>int</em> <dfn class="decl" id="job_thread::jobs_running" title='job_thread::jobs_running' data-ref="job_thread::jobs_running">jobs_running</dfn>[<a class="macro" href="#112" title="0xf" data-ref="_M/JC_MAX">JC_MAX</a>+<var>1</var>];</td></tr>
<tr><th id="231">231</th><td>  <em>long</em> <em>long</em> <dfn class="decl" id="job_thread::jobs_created" title='job_thread::jobs_created' data-ref="job_thread::jobs_created">jobs_created</dfn>;</td></tr>
<tr><th id="232">232</th><td>  <em>long</em> <em>long</em> <dfn class="decl" id="job_thread::jobs_active" title='job_thread::jobs_active' data-ref="job_thread::jobs_active">jobs_active</dfn>;</td></tr>
<tr><th id="233">233</th><td>  <em>int</em> <dfn class="decl" id="job_thread::thread_system_id" title='job_thread::thread_system_id' data-ref="job_thread::thread_system_id">thread_system_id</dfn>;</td></tr>
<tr><th id="234">234</th><td>  <b>struct</b> <a class="type" href="../../include/stdlib.h.html#drand48_data" title='drand48_data' data-ref="drand48_data">drand48_data</a> <dfn class="decl" id="job_thread::rand_data" title='job_thread::rand_data' data-ref="job_thread::rand_data">rand_data</dfn>;</td></tr>
<tr><th id="235">235</th><td>  <a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="decl" id="job_thread::timer_manager" title='job_thread::timer_manager' data-ref="job_thread::timer_manager">timer_manager</dfn>;</td></tr>
<tr><th id="236">236</th><td>  <em>double</em> <dfn class="decl" id="job_thread::wakeup_time" title='job_thread::wakeup_time' data-ref="job_thread::wakeup_time">wakeup_time</dfn>;</td></tr>
<tr><th id="237">237</th><td>  <b>struct</b> <a class="type" href="#job_class" title='job_class' data-ref="job_class">job_class</a> *<dfn class="decl" id="job_thread::job_class" title='job_thread::job_class' data-ref="job_thread::job_class">job_class</dfn>;</td></tr>
<tr><th id="238">238</th><td>} <b>__attribute__</b>((aligned(<var>128</var>)));</td></tr>
<tr><th id="239">239</th><td></td></tr>
<tr><th id="240">240</th><td><b>struct</b> <dfn class="type def" id="job_message" title='job_message' data-ref="job_message">job_message</dfn> {</td></tr>
<tr><th id="241">241</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl" id="job_message::type" title='job_message::type' data-ref="job_message::type">type</dfn>;  </td></tr>
<tr><th id="242">242</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl" id="job_message::flags" title='job_message::flags' data-ref="job_message::flags">flags</dfn>;</td></tr>
<tr><th id="243">243</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl" id="job_message::payload_ints" title='job_message::payload_ints' data-ref="job_message::payload_ints">payload_ints</dfn>;</td></tr>
<tr><th id="244">244</th><td>  <a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="decl" id="job_message::src" title='job_message::src' data-ref="job_message::src">src</dfn>;</td></tr>
<tr><th id="245">245</th><td>  <em>void</em> (*<dfn class="decl" id="job_message::destructor" title='job_message::destructor' data-ref="job_message::destructor">destructor</dfn>)(<b>struct</b> <a class="type" href="#job_message" title='job_message' data-ref="job_message">job_message</a> *<dfn class="local col7 decl" id="1837M" title='M' data-type='struct job_message *' data-ref="1837M">M</dfn>);</td></tr>
<tr><th id="246">246</th><td>  <b>struct</b> <a class="type" href="../net/net-msg.h.html#raw_message" title='raw_message' data-ref="raw_message">raw_message</a> <dfn class="decl" id="job_message::message" title='job_message::message' data-ref="job_message::message">message</dfn>;   </td></tr>
<tr><th id="247">247</th><td>  <b>struct</b> <a class="type" href="#job_message" title='job_message' data-ref="job_message">job_message</a> *<dfn class="decl" id="job_message::next" title='job_message::next' data-ref="job_message::next">next</dfn>;</td></tr>
<tr><th id="248">248</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl" id="job_message::payload" title='job_message::payload' data-ref="job_message::payload">payload</dfn>[<var>0</var>];</td></tr>
<tr><th id="249">249</th><td>};</td></tr>
<tr><th id="250">250</th><td></td></tr>
<tr><th id="251">251</th><td><b>struct</b> <dfn class="type def" id="job_message_queue" title='job_message_queue' data-ref="job_message_queue">job_message_queue</dfn> {</td></tr>
<tr><th id="252">252</th><td>  <b>struct</b> <a class="type" href="../common/mp-queue.h.html#mp_queue" title='mp_queue' data-ref="mp_queue">mp_queue</a> *<dfn class="decl" id="job_message_queue::unsorted" title='job_message_queue::unsorted' data-ref="job_message_queue::unsorted">unsorted</dfn>;</td></tr>
<tr><th id="253">253</th><td>  <b>struct</b> <a class="type" href="#job_message" title='job_message' data-ref="job_message">job_message</a> *<dfn class="decl" id="job_message_queue::first" title='job_message_queue::first' data-ref="job_message_queue::first">first</dfn>, *<dfn class="decl" id="job_message_queue::last" title='job_message_queue::last' data-ref="job_message_queue::last">last</dfn>;</td></tr>
<tr><th id="254">254</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl" id="job_message_queue::payload_magic" title='job_message_queue::payload_magic' data-ref="job_message_queue::payload_magic">payload_magic</dfn>;</td></tr>
<tr><th id="255">255</th><td>};</td></tr>
<tr><th id="256">256</th><td></td></tr>
<tr><th id="257">257</th><td><b>struct</b> <dfn class="type def" id="job_timer_info" title='job_timer_info' data-ref="job_timer_info">job_timer_info</dfn> {</td></tr>
<tr><th id="258">258</th><td>  <b>struct</b> <a class="type" href="../net/net-timers.h.html#event_timer" title='event_timer' data-ref="event_timer">event_timer</a> <dfn class="decl" id="job_timer_info::ev" title='job_timer_info::ev' data-ref="job_timer_info::ev">ev</dfn>;</td></tr>
<tr><th id="259">259</th><td>  <em>void</em> *<dfn class="decl" id="job_timer_info::extra" title='job_timer_info::extra' data-ref="job_timer_info::extra">extra</dfn>;</td></tr>
<tr><th id="260">260</th><td>  <em>double</em> (*<dfn class="decl" id="job_timer_info::wakeup" title='job_timer_info::wakeup' data-ref="job_timer_info::wakeup">wakeup</dfn>)(<em>void</em> *);</td></tr>
<tr><th id="261">261</th><td>};</td></tr>
<tr><th id="262">262</th><td></td></tr>
<tr><th id="263">263</th><td><u>#define <dfn class="macro" id="_M/MAX_JOB_THREADS" data-ref="_M/MAX_JOB_THREADS">MAX_JOB_THREADS</dfn>		256</u></td></tr>
<tr><th id="264">264</th><td></td></tr>
<tr><th id="265">265</th><td><em>long</em> <em>int</em> <dfn class="decl" id="lrand48_j" title='lrand48_j' data-ref="lrand48_j">lrand48_j</dfn> (<em>void</em>);</td></tr>
<tr><th id="266">266</th><td><em>long</em> <em>int</em> <dfn class="decl" id="mrand48_j" title='mrand48_j' data-ref="mrand48_j">mrand48_j</dfn> (<em>void</em>);</td></tr>
<tr><th id="267">267</th><td><em>double</em> <dfn class="decl" id="drand48_j" title='drand48_j' data-ref="drand48_j">drand48_j</dfn> (<em>void</em>);</td></tr>
<tr><th id="268">268</th><td></td></tr>
<tr><th id="269">269</th><td><em>int</em> <dfn class="decl" id="init_async_jobs" title='init_async_jobs' data-ref="init_async_jobs">init_async_jobs</dfn> (<em>void</em>);</td></tr>
<tr><th id="270">270</th><td><em>int</em> <dfn class="decl" id="create_job_class" title='create_job_class' data-ref="create_job_class">create_job_class</dfn> (<em>int</em> <dfn class="local col8 decl" id="1838job_class" title='job_class' data-type='int' data-ref="1838job_class">job_class</dfn>, <em>int</em> <dfn class="local col9 decl" id="1839min_threads" title='min_threads' data-type='int' data-ref="1839min_threads">min_threads</dfn>, <em>int</em> <dfn class="local col0 decl" id="1840max_threads" title='max_threads' data-type='int' data-ref="1840max_threads">max_threads</dfn>, <em>int</em> <dfn class="local col1 decl" id="1841excl" title='excl' data-type='int' data-ref="1841excl">excl</dfn>);</td></tr>
<tr><th id="271">271</th><td><em>int</em> <dfn class="decl" id="create_job_class_sub" title='create_job_class_sub' data-ref="create_job_class_sub">create_job_class_sub</dfn> (<em>int</em> <dfn class="local col2 decl" id="1842job_class" title='job_class' data-type='int' data-ref="1842job_class">job_class</dfn>, <em>int</em> <dfn class="local col3 decl" id="1843min_threads" title='min_threads' data-type='int' data-ref="1843min_threads">min_threads</dfn>, <em>int</em> <dfn class="local col4 decl" id="1844max_threads" title='max_threads' data-type='int' data-ref="1844max_threads">max_threads</dfn>, <em>int</em> <dfn class="local col5 decl" id="1845excl" title='excl' data-type='int' data-ref="1845excl">excl</dfn>, <em>int</em> <dfn class="local col6 decl" id="1846subclass_cnt" title='subclass_cnt' data-type='int' data-ref="1846subclass_cnt">subclass_cnt</dfn>);</td></tr>
<tr><th id="272">272</th><td><a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="decl" id="notify_job_create" title='notify_job_create' data-ref="notify_job_create">notify_job_create</dfn> (<em>int</em> <dfn class="local col7 decl" id="1847sig_class" title='sig_class' data-type='int' data-ref="1847sig_class">sig_class</dfn>);</td></tr>
<tr><th id="273">273</th><td><em>int</em> <dfn class="decl" id="create_job_thread_ex" title='create_job_thread_ex' data-ref="create_job_thread_ex">create_job_thread_ex</dfn> (<em>int</em> <dfn class="local col8 decl" id="1848thread_class" title='thread_class' data-type='int' data-ref="1848thread_class">thread_class</dfn>, <em>void</em> *(*<dfn class="local col9 decl" id="1849thread_work" title='thread_work' data-type='void *(*)(void *)' data-ref="1849thread_work">thread_work</dfn>)(<em>void</em> *));</td></tr>
<tr><th id="274">274</th><td><em>int</em> <dfn class="decl" id="create_new_job_class" title='create_new_job_class' data-ref="create_new_job_class">create_new_job_class</dfn> (<em>int</em> <dfn class="local col0 decl" id="1850job_class" title='job_class' data-type='int' data-ref="1850job_class">job_class</dfn>, <em>int</em> <dfn class="local col1 decl" id="1851min_threads" title='min_threads' data-type='int' data-ref="1851min_threads">min_threads</dfn>, <em>int</em> <dfn class="local col2 decl" id="1852max_threads" title='max_threads' data-type='int' data-ref="1852max_threads">max_threads</dfn>);</td></tr>
<tr><th id="275">275</th><td><em>int</em> <dfn class="decl" id="create_new_job_class_sub" title='create_new_job_class_sub' data-ref="create_new_job_class_sub">create_new_job_class_sub</dfn> (<em>int</em> <dfn class="local col3 decl" id="1853job_class" title='job_class' data-type='int' data-ref="1853job_class">job_class</dfn>, <em>int</em> <dfn class="local col4 decl" id="1854min_threads" title='min_threads' data-type='int' data-ref="1854min_threads">min_threads</dfn>, <em>int</em> <dfn class="local col5 decl" id="1855max_threads" title='max_threads' data-type='int' data-ref="1855max_threads">max_threads</dfn>, <em>int</em> <dfn class="local col6 decl" id="1856subclass_cnt" title='subclass_cnt' data-type='int' data-ref="1856subclass_cnt">subclass_cnt</dfn>);</td></tr>
<tr><th id="276">276</th><td><em>void</em> *<dfn class="decl" id="job_thread_ex" title='job_thread_ex' data-ref="job_thread_ex">job_thread_ex</dfn> (<em>void</em> *<dfn class="local col7 decl" id="1857arg" title='arg' data-type='void *' data-ref="1857arg">arg</dfn>, <em>void</em> (*<dfn class="local col8 decl" id="1858work_one" title='work_one' data-type='void (*)(void *, int)' data-ref="1858work_one">work_one</dfn>)(<em>void</em> *, <em>int</em>));</td></tr>
<tr><th id="277">277</th><td></td></tr>
<tr><th id="278">278</th><td><i>/* creates a new async job as described */</i></td></tr>
<tr><th id="279">279</th><td><a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="decl" id="create_async_job" title='create_async_job' data-ref="create_async_job">create_async_job</dfn> (<a class="typedef" href="#job_function_t" title='job_function_t' data-type='int (*)(job_t, int, struct job_thread *)' data-ref="job_function_t">job_function_t</a> <dfn class="local col9 decl" id="1859run_job" title='run_job' data-type='job_function_t' data-ref="1859run_job">run_job</dfn>, <em>unsigned</em> <em>long</em> <em>long</em> <dfn class="local col0 decl" id="1860job_signals" title='job_signals' data-type='unsigned long long' data-ref="1860job_signals">job_signals</dfn>, <em>int</em> <dfn class="local col1 decl" id="1861job_subclass" title='job_subclass' data-type='int' data-ref="1861job_subclass">job_subclass</dfn>, <em>int</em> <dfn class="local col2 decl" id="1862custom_bytes" title='custom_bytes' data-type='int' data-ref="1862custom_bytes">custom_bytes</dfn>, <em>unsigned</em> <em>long</em> <em>long</em> <dfn class="local col3 decl" id="1863job_type" title='job_type' data-type='unsigned long long' data-ref="1863job_type">job_type</dfn>, <a class="macro" href="#46" title="int parent_job_tag_int, job_t parent_job" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col4 decl" id="1864parent_job" title='parent_job' data-type='job_t' data-ref="1864parent_job">parent_job</dfn>));</td></tr>
<tr><th id="280">280</th><td><em>void</em> <dfn class="decl" id="job_change_signals" title='job_change_signals' data-ref="job_change_signals">job_change_signals</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col5 decl" id="1865job" title='job' data-type='job_t' data-ref="1865job">job</dfn>, <em>unsigned</em> <em>long</em> <em>long</em> <dfn class="local col6 decl" id="1866job_signals" title='job_signals' data-type='unsigned long long' data-ref="1866job_signals">job_signals</dfn>);</td></tr>
<tr><th id="281">281</th><td><i>/* puts job into execution queue according to its priority class (actually, unlocks it and sends signal 0) */</i></td></tr>
<tr><th id="282">282</th><td><em>int</em> <dfn class="decl" id="schedule_job" title='schedule_job' data-ref="schedule_job">schedule_job</dfn> (<a class="macro" href="#46" title="int job_tag_int, job_t job" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col7 decl" id="1867job" title='job' data-type='job_t' data-ref="1867job">job</dfn>));</td></tr>
<tr><th id="283">283</th><td></td></tr>
<tr><th id="284">284</th><td><a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="decl" id="job_incref" title='job_incref' data-ref="job_incref">job_incref</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col8 decl" id="1868job" title='job' data-type='job_t' data-ref="1868job">job</dfn>);</td></tr>
<tr><th id="285">285</th><td><em>static</em> <b>inline</b> <a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="decl def" id="job_incref_f" title='job_incref_f' data-ref="job_incref_f">job_incref_f</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col9 decl" id="1869job" title='job' data-type='job_t' data-ref="1869job">job</dfn>) {</td></tr>
<tr><th id="286">286</th><td>  <b>if</b> (<a class="local col9 ref" href="#1869job" title='job' data-ref="1869job">job</a>) {</td></tr>
<tr><th id="287">287</th><td>    <a class="ref" href="#job_incref" title='job_incref' data-ref="job_incref">job_incref</a> (<a class="local col9 ref" href="#1869job" title='job' data-ref="1869job">job</a>);</td></tr>
<tr><th id="288">288</th><td>  }</td></tr>
<tr><th id="289">289</th><td>  <b>return</b> <a class="local col9 ref" href="#1869job" title='job' data-ref="1869job">job</a>;</td></tr>
<tr><th id="290">290</th><td>}</td></tr>
<tr><th id="291">291</th><td><em>void</em> <dfn class="decl" id="job_decref" title='job_decref' data-ref="job_decref">job_decref</dfn> (<a class="macro" href="#46" title="int job_tag_int, job_t job" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col0 decl" id="1870job" title='job' data-type='job_t' data-ref="1870job">job</dfn>));	<i>// if job-&gt;j_refcnt becomes 0, invokes j_execute with op = JS_FREE</i></td></tr>
<tr><th id="292">292</th><td><em>static</em> <b>inline</b> <em>void</em> <dfn class="decl def" id="job_decref_f" title='job_decref_f' data-ref="job_decref_f">job_decref_f</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col1 decl" id="1871job" title='job' data-type='job_t' data-ref="1871job">job</dfn>) {</td></tr>
<tr><th id="293">293</th><td>  <a class="ref" href="#job_decref" title='job_decref' data-ref="job_decref">job_decref</a> (<a class="macro" href="#47" title="1, ({ typeof(job) __ptr_v_save = job; job = ((void*)0); __ptr_v_save; })" data-ref="_M/JOB_REF_PASS">JOB_REF_PASS</a> (<a class="local col1 ref" href="#1871job" title='job' data-ref="1871job">job</a>));</td></tr>
<tr><th id="294">294</th><td>}</td></tr>
<tr><th id="295">295</th><td></td></tr>
<tr><th id="296">296</th><td><em>int</em> <dfn class="decl" id="unlock_job" title='unlock_job' data-ref="unlock_job">unlock_job</dfn> (<a class="macro" href="#46" title="int job_tag_int, job_t job" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col3 decl" id="1873job" title='job' data-type='job_t' data-ref="1873job">job</dfn>));</td></tr>
<tr><th id="297">297</th><td><em>int</em> <dfn class="decl" id="try_lock_job" title='try_lock_job' data-ref="try_lock_job">try_lock_job</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col4 decl" id="1874job" title='job' data-type='job_t' data-ref="1874job">job</dfn>, <em>int</em> <dfn class="local col5 decl" id="1875set_flags" title='set_flags' data-type='int' data-ref="1875set_flags">set_flags</dfn>, <em>int</em> <dfn class="local col6 decl" id="1876clear_flags" title='clear_flags' data-type='int' data-ref="1876clear_flags">clear_flags</dfn>);</td></tr>
<tr><th id="298">298</th><td></td></tr>
<tr><th id="299">299</th><td><em>void</em> <dfn class="decl" id="complete_job" title='complete_job' data-ref="complete_job">complete_job</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col7 decl" id="1877job" title='job' data-type='job_t' data-ref="1877job">job</dfn>);	<i>// if JF_COMPLETED is not set, sets it and acts according to JFS_PARENT_*</i></td></tr>
<tr><th id="300">300</th><td></td></tr>
<tr><th id="301">301</th><td><em>int</em> <dfn class="decl" id="change_locked_job_subclass" title='change_locked_job_subclass' data-ref="change_locked_job_subclass">change_locked_job_subclass</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col8 decl" id="1878job" title='job' data-type='job_t' data-ref="1878job">job</dfn>, <em>int</em> <dfn class="local col9 decl" id="1879new_subclass" title='new_subclass' data-type='int' data-ref="1879new_subclass">new_subclass</dfn>);</td></tr>
<tr><th id="302">302</th><td></td></tr>
<tr><th id="303">303</th><td><em>static</em> <b>inline</b> <em>int</em> <dfn class="decl def" id="check_job_completion" title='check_job_completion' data-ref="check_job_completion">check_job_completion</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col0 decl" id="1880job" title='job' data-type='job_t' data-ref="1880job">job</dfn>) {</td></tr>
<tr><th id="304">304</th><td>  <b>return</b> <a class="local col0 ref" href="#1880job" title='job' data-ref="1880job">job</a>-&gt;<a class="ref" href="#async_job::j_flags" title='async_job::j_flags' data-ref="async_job::j_flags">j_flags</a> &amp; <a class="macro" href="#117" title="0x40000" data-ref="_M/JF_COMPLETED">JF_COMPLETED</a>;</td></tr>
<tr><th id="305">305</th><td>}</td></tr>
<tr><th id="306">306</th><td><em>static</em> <b>inline</b> <em>int</em> <dfn class="decl def" id="check_job_validity" title='check_job_validity' data-ref="check_job_validity">check_job_validity</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col1 decl" id="1881job" title='job' data-type='job_t' data-ref="1881job">job</dfn>) {</td></tr>
<tr><th id="307">307</th><td>  <b>return</b> <a class="local col1 ref" href="#1881job" title='job' data-ref="1881job">job</a> &amp;&amp; !<a class="ref" href="#check_job_completion" title='check_job_completion' data-ref="check_job_completion">check_job_completion</a> (<a class="local col1 ref" href="#1881job" title='job' data-ref="1881job">job</a>);</td></tr>
<tr><th id="308">308</th><td>}</td></tr>
<tr><th id="309">309</th><td><em>static</em> <b>inline</b> <em>int</em> <dfn class="decl def" id="check_parent_job_validity" title='check_parent_job_validity' data-ref="check_parent_job_validity">check_parent_job_validity</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col2 decl" id="1882job" title='job' data-type='job_t' data-ref="1882job">job</dfn>) {</td></tr>
<tr><th id="310">310</th><td>  <b>return</b> <a class="ref" href="#check_job_validity" title='check_job_validity' data-ref="check_job_validity">check_job_validity</a> (<a class="local col2 ref" href="#1882job" title='job' data-ref="1882job">job</a>-&gt;<a class="ref" href="#async_job::j_parent" title='async_job::j_parent' data-ref="async_job::j_parent">j_parent</a>);</td></tr>
<tr><th id="311">311</th><td>}</td></tr>
<tr><th id="312">312</th><td><em>static</em> <b>inline</b> <em>int</em> <dfn class="decl def" id="parent_job_aborted" title='parent_job_aborted' data-ref="parent_job_aborted">parent_job_aborted</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col3 decl" id="1883job" title='job' data-type='job_t' data-ref="1883job">job</dfn>) {</td></tr>
<tr><th id="313">313</th><td>  <b>return</b> (<a class="local col3 ref" href="#1883job" title='job' data-ref="1883job">job</a>-&gt;<a class="ref" href="#async_job::j_status" title='async_job::j_status' data-ref="async_job::j_status">j_status</a> &amp; <a class="macro" href="#149" title="0x10" data-ref="_M/JSP_PARENT_INCOMPLETE">JSP_PARENT_INCOMPLETE</a>) &amp;&amp; <a class="local col3 ref" href="#1883job" title='job' data-ref="1883job">job</a>-&gt;<a class="ref" href="#async_job::j_parent" title='async_job::j_parent' data-ref="async_job::j_parent">j_parent</a> &amp;&amp; <a class="ref" href="#check_job_completion" title='check_job_completion' data-ref="check_job_completion">check_job_completion</a> (<a class="local col3 ref" href="#1883job" title='job' data-ref="1883job">job</a>-&gt;<a class="ref" href="#async_job::j_parent" title='async_job::j_parent' data-ref="async_job::j_parent">j_parent</a>);</td></tr>
<tr><th id="314">314</th><td>}</td></tr>
<tr><th id="315">315</th><td><em>static</em> <b>inline</b> <em>int</em> <dfn class="decl def" id="job_parent_ptr_valid" title='job_parent_ptr_valid' data-ref="job_parent_ptr_valid">job_parent_ptr_valid</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col4 decl" id="1884job" title='job' data-type='job_t' data-ref="1884job">job</dfn>) {</td></tr>
<tr><th id="316">316</th><td>  <b>return</b> (!(<a class="local col4 ref" href="#1884job" title='job' data-ref="1884job">job</a>-&gt;<a class="ref" href="#async_job::j_status" title='async_job::j_status' data-ref="async_job::j_status">j_status</a> &amp; <a class="macro" href="#148" title="8" data-ref="_M/JSP_PARENT_RESPTR">JSP_PARENT_RESPTR</a>) || <a class="ref" href="#check_parent_job_validity" title='check_parent_job_validity' data-ref="check_parent_job_validity">check_parent_job_validity</a> (<a class="local col4 ref" href="#1884job" title='job' data-ref="1884job">job</a>));</td></tr>
<tr><th id="317">317</th><td>}</td></tr>
<tr><th id="318">318</th><td><em>static</em> <b>inline</b> <em>int</em> <dfn class="decl def" id="job_fatal" title='job_fatal' data-ref="job_fatal">job_fatal</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col5 decl" id="1885job" title='job' data-type='job_t' data-ref="1885job">job</dfn>, <em>int</em> <dfn class="local col6 decl" id="1886error" title='error' data-type='int' data-ref="1886error">error</dfn>) {</td></tr>
<tr><th id="319">319</th><td>  <b>if</b> (!<a class="local col5 ref" href="#1885job" title='job' data-ref="1885job">job</a>-&gt;<a class="ref" href="#async_job::j_error" title='async_job::j_error' data-ref="async_job::j_error">j_error</a>) {</td></tr>
<tr><th id="320">320</th><td>    <a class="local col5 ref" href="#1885job" title='job' data-ref="1885job">job</a>-&gt;<a class="ref" href="#async_job::j_error" title='async_job::j_error' data-ref="async_job::j_error">j_error</a> = <a class="local col6 ref" href="#1886error" title='error' data-ref="1886error">error</a>;</td></tr>
<tr><th id="321">321</th><td>  }</td></tr>
<tr><th id="322">322</th><td>  <b>return</b> <a class="macro" href="#62" title="0x100" data-ref="_M/JOB_COMPLETED">JOB_COMPLETED</a>;</td></tr>
<tr><th id="323">323</th><td>}</td></tr>
<tr><th id="324">324</th><td></td></tr>
<tr><th id="325">325</th><td><i>/* runs all pending jobs of class JF_CLASS_MAIN, then returns */</i></td></tr>
<tr><th id="326">326</th><td><em>int</em> <dfn class="decl" id="run_pending_main_jobs" title='run_pending_main_jobs' data-ref="run_pending_main_jobs">run_pending_main_jobs</dfn> (<em>void</em>);</td></tr>
<tr><th id="327">327</th><td></td></tr>
<tr><th id="328">328</th><td></td></tr>
<tr><th id="329">329</th><td><i>/* ----------- JOB WAIT QUEUE ------ */</i></td></tr>
<tr><th id="330">330</th><td></td></tr>
<tr><th id="331">331</th><td><b>struct</b> <a class="type" href="#job_list_node" title='job_list_node' data-ref="job_list_node">job_list_node</a>;</td></tr>
<tr><th id="332">332</th><td></td></tr>
<tr><th id="333">333</th><td><b>typedef</b> <em>int</em> (*<dfn class="typedef" id="job_list_node_type_t" title='job_list_node_type_t' data-type='int (*)(job_t, int, struct job_list_node *)' data-ref="job_list_node_type_t">job_list_node_type_t</dfn>)(<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col7 decl" id="1887list_job" title='list_job' data-type='job_t' data-ref="1887list_job">list_job</dfn>, <em>int</em> <dfn class="local col8 decl" id="1888op" title='op' data-type='int' data-ref="1888op">op</dfn>, <b>struct</b> <a class="type" href="#job_list_node" title='job_list_node' data-ref="job_list_node">job_list_node</a> *<dfn class="local col9 decl" id="1889w" title='w' data-type='struct job_list_node *' data-ref="1889w">w</dfn>);</td></tr>
<tr><th id="334">334</th><td></td></tr>
<tr><th id="335">335</th><td><b>struct</b> <dfn class="type def" id="job_list_node" title='job_list_node' data-ref="job_list_node">job_list_node</dfn> {</td></tr>
<tr><th id="336">336</th><td>  <b>struct</b> <a class="type" href="#job_list_node" title='job_list_node' data-ref="job_list_node">job_list_node</a> *<dfn class="decl" id="job_list_node::jl_next" title='job_list_node::jl_next' data-ref="job_list_node::jl_next">jl_next</dfn>;</td></tr>
<tr><th id="337">337</th><td>  <a class="typedef" href="#job_list_node_type_t" title='job_list_node_type_t' data-type='int (*)(job_t, int, struct job_list_node *)' data-ref="job_list_node_type_t">job_list_node_type_t</a> <dfn class="decl" id="job_list_node::jl_type" title='job_list_node::jl_type' data-ref="job_list_node::jl_type">jl_type</dfn>;</td></tr>
<tr><th id="338">338</th><td>  <em>int</em> <dfn class="decl" id="job_list_node::jl_custom" title='job_list_node::jl_custom' data-ref="job_list_node::jl_custom">jl_custom</dfn>[<var>0</var>];</td></tr>
<tr><th id="339">339</th><td>};</td></tr>
<tr><th id="340">340</th><td></td></tr>
<tr><th id="341">341</th><td><a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="decl" id="create_job_list" title='create_job_list' data-ref="create_job_list">create_job_list</dfn> (<em>void</em>);</td></tr>
<tr><th id="342">342</th><td><em>int</em> <dfn class="decl" id="insert_job_into_job_list" title='insert_job_into_job_list' data-ref="insert_job_into_job_list">insert_job_into_job_list</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col0 decl" id="1890list_job" title='list_job' data-type='job_t' data-ref="1890list_job">list_job</dfn>, <a class="macro" href="#46" title="int job_tag_int, job_t job" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a>(<dfn class="local col1 decl" id="1891job" title='job' data-type='job_t' data-ref="1891job">job</dfn>), <em>int</em> <dfn class="local col2 decl" id="1892mode" title='mode' data-type='int' data-ref="1892mode">mode</dfn>);</td></tr>
<tr><th id="343">343</th><td><em>void</em> <dfn class="decl" id="update_all_thread_stats" title='update_all_thread_stats' data-ref="update_all_thread_stats">update_all_thread_stats</dfn> (<em>void</em>);</td></tr>
<tr><th id="344">344</th><td></td></tr>
<tr><th id="345">345</th><td><i>/* adds job to the list of jobs awaited by connection */</i></td></tr>
<tr><th id="346">346</th><td><i>// int conn_wait_job (job_t job, connection_job_t c, double timeout, struct conn_query_functions *cq);</i></td></tr>
<tr><th id="347">347</th><td><i>/* increases connection's generation (effectively clearing list of awaited jobs), then adds given job */</i></td></tr>
<tr><th id="348">348</th><td><i>// int conn_wait_only_job (job_t job, connection_job_t c, double timeout, struct conn_query_functions *cq);</i></td></tr>
<tr><th id="349">349</th><td></td></tr>
<tr><th id="350">350</th><td><b>extern</b> <em>int</em> <dfn class="decl" id="max_job_thread_id" title='max_job_thread_id' data-ref="max_job_thread_id">max_job_thread_id</dfn>;</td></tr>
<tr><th id="351">351</th><td></td></tr>
<tr><th id="352">352</th><td><em>void</em> <dfn class="decl" id="check_main_thread" title='check_main_thread' data-ref="check_main_thread">check_main_thread</dfn> (<em>void</em>);</td></tr>
<tr><th id="353">353</th><td><em>int</em> <dfn class="decl" id="job_timer_wakeup_gateway" title='job_timer_wakeup_gateway' data-ref="job_timer_wakeup_gateway">job_timer_wakeup_gateway</dfn> (<a class="typedef" href="../net/net-timers.h.html#event_timer_t" title='event_timer_t' data-type='struct event_timer' data-ref="event_timer_t">event_timer_t</a> *<dfn class="local col3 decl" id="1893et" title='et' data-type='event_timer_t *' data-ref="1893et">et</dfn>);</td></tr>
<tr><th id="354">354</th><td><em>int</em> <dfn class="decl" id="job_timer_check" title='job_timer_check' data-ref="job_timer_check">job_timer_check</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col4 decl" id="1894job" title='job' data-type='job_t' data-ref="1894job">job</dfn>);</td></tr>
<tr><th id="355">355</th><td><em>void</em> <dfn class="decl" id="job_signal" title='job_signal' data-ref="job_signal">job_signal</dfn> (<a class="macro" href="#46" title="int job_tag_int, job_t job" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col5 decl" id="1895job" title='job' data-type='job_t' data-ref="1895job">job</dfn>), <em>int</em> <dfn class="local col6 decl" id="1896signo" title='signo' data-type='int' data-ref="1896signo">signo</dfn>);</td></tr>
<tr><th id="356">356</th><td><em>void</em> <dfn class="decl" id="complete_subjob" title='complete_subjob' data-ref="complete_subjob">complete_subjob</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col7 decl" id="1897job" title='job' data-type='job_t' data-ref="1897job">job</dfn>, <a class="macro" href="#46" title="int parent_tag_int, job_t parent" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col8 decl" id="1898parent" title='parent' data-type='job_t' data-ref="1898parent">parent</dfn>), <em>int</em> <dfn class="local col9 decl" id="1899status" title='status' data-type='int' data-ref="1899status">status</dfn>);</td></tr>
<tr><th id="357">357</th><td><em>void</em> <dfn class="decl" id="job_timer_insert" title='job_timer_insert' data-ref="job_timer_insert">job_timer_insert</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col0 decl" id="1900job" title='job' data-type='job_t' data-ref="1900job">job</dfn>, <em>double</em> <dfn class="local col1 decl" id="1901timeout" title='timeout' data-type='double' data-ref="1901timeout">timeout</dfn>);</td></tr>
<tr><th id="358">358</th><td><em>void</em> <dfn class="decl" id="job_timer_remove" title='job_timer_remove' data-ref="job_timer_remove">job_timer_remove</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col2 decl" id="1902job" title='job' data-type='job_t' data-ref="1902job">job</dfn>);</td></tr>
<tr><th id="359">359</th><td><em>int</em> <dfn class="decl" id="job_timer_active" title='job_timer_active' data-ref="job_timer_active">job_timer_active</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col3 decl" id="1903job" title='job' data-type='job_t' data-ref="1903job">job</dfn>);</td></tr>
<tr><th id="360">360</th><td><em>void</em> <dfn class="decl" id="job_timer_init" title='job_timer_init' data-ref="job_timer_init">job_timer_init</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col4 decl" id="1904job" title='job' data-type='job_t' data-ref="1904job">job</dfn>);</td></tr>
<tr><th id="361">361</th><td><em>double</em> <dfn class="decl" id="job_timer_wakeup_time" title='job_timer_wakeup_time' data-ref="job_timer_wakeup_time">job_timer_wakeup_time</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col5 decl" id="1905job" title='job' data-type='job_t' data-ref="1905job">job</dfn>);</td></tr>
<tr><th id="362">362</th><td><em>void</em> <dfn class="decl" id="jobs_check_all_timers" title='jobs_check_all_timers' data-ref="jobs_check_all_timers">jobs_check_all_timers</dfn> (<em>void</em>);</td></tr>
<tr><th id="363">363</th><td></td></tr>
<tr><th id="364">364</th><td><em>static</em> <b>inline</b> <em>void</em> <dfn class="decl def" id="check_thread_class" title='check_thread_class' data-ref="check_thread_class">check_thread_class</dfn> (<em>int</em> <dfn class="local col6 decl" id="1906class" title='class' data-type='int' data-ref="1906class">class</dfn>) {</td></tr>
<tr><th id="365">365</th><td>  <a class="macro" href="../../include/assert.h.html#88" title="((this_job_thread-&gt;job_class_mask &amp; (1 &lt;&lt; class)) ? (void) (0) : __assert_fail (&quot;this_job_thread-&gt;job_class_mask &amp; (1 &lt;&lt; class)&quot;, &quot;/home/parallels/MTProxy/./jobs/jobs.h&quot;, 365, __PRETTY_FUNCTION__))" data-ref="_M/assert">assert</a> (<a class="ref" href="#this_job_thread" title='this_job_thread' data-ref="this_job_thread">this_job_thread</a>-&gt;<a class="ref" href="#job_thread::job_class_mask" title='job_thread::job_class_mask' data-ref="job_thread::job_class_mask">job_class_mask</a> &amp; (<var>1</var> &lt;&lt; <a class="local col6 ref" href="#1906class" title='class' data-ref="1906class">class</a>));</td></tr>
<tr><th id="366">366</th><td>}</td></tr>
<tr><th id="367">367</th><td></td></tr>
<tr><th id="368">368</th><td><em>void</em> <dfn class="decl" id="job_message_send" title='job_message_send' data-ref="job_message_send">job_message_send</dfn> (<a class="macro" href="#46" title="int job_tag_int, job_t job" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col7 decl" id="1907job" title='job' data-type='job_t' data-ref="1907job">job</dfn>), <a class="macro" href="#46" title="int src_tag_int, job_t src" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col8 decl" id="1908src" title='src' data-type='job_t' data-ref="1908src">src</dfn>), <em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="1909type" title='type' data-type='unsigned int' data-ref="1909type">type</dfn>, <b>struct</b> <a class="type" href="../net/net-msg.h.html#raw_message" title='raw_message' data-ref="raw_message">raw_message</a> *<dfn class="local col0 decl" id="1910raw" title='raw' data-type='struct raw_message *' data-ref="1910raw">raw</dfn>, <em>int</em> <dfn class="local col1 decl" id="1911dup" title='dup' data-type='int' data-ref="1911dup">dup</dfn>, <em>int</em> <dfn class="local col2 decl" id="1912payload_ints" title='payload_ints' data-type='int' data-ref="1912payload_ints">payload_ints</dfn>, <em>const</em> <em>unsigned</em> <em>int</em> *<dfn class="local col3 decl" id="1913payload" title='payload' data-type='const unsigned int *' data-ref="1913payload">payload</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col4 decl" id="1914flags" title='flags' data-type='unsigned int' data-ref="1914flags">flags</dfn>, <em>void</em> (*<dfn class="local col5 decl" id="1915destructor" title='destructor' data-type='void (*)(struct job_message *)' data-ref="1915destructor">destructor</dfn>)(<b>struct</b> <a class="type" href="#job_message" title='job_message' data-ref="job_message">job_message</a> *<dfn class="local col6 decl" id="1916M" title='M' data-type='struct job_message *' data-ref="1916M">M</dfn>));</td></tr>
<tr><th id="369">369</th><td><em>void</em> <dfn class="decl" id="job_message_send_fake" title='job_message_send_fake' data-ref="job_message_send_fake">job_message_send_fake</dfn> (<a class="macro" href="#46" title="int job_tag_int, job_t job" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col7 decl" id="1917job" title='job' data-type='job_t' data-ref="1917job">job</dfn>), <em>int</em> (*<dfn class="local col8 decl" id="1918receive_message" title='receive_message' data-type='int (*)(job_t, struct job_message *, void *)' data-ref="1918receive_message">receive_message</dfn>)(<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col9 decl" id="1919job" title='job' data-type='job_t' data-ref="1919job">job</dfn>, <b>struct</b> <a class="type" href="#job_message" title='job_message' data-ref="job_message">job_message</a> *<dfn class="local col0 decl" id="1920M" title='M' data-type='struct job_message *' data-ref="1920M">M</dfn>, <em>void</em> *<dfn class="local col1 decl" id="1921extra" title='extra' data-type='void *' data-ref="1921extra">extra</dfn>), <em>void</em> *<dfn class="local col2 decl" id="1922extra" title='extra' data-type='void *' data-ref="1922extra">extra</dfn>, <a class="macro" href="#46" title="int src_tag_int, job_t src" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col3 decl" id="1923src" title='src' data-type='job_t' data-ref="1923src">src</dfn>), <em>unsigned</em> <em>int</em> <dfn class="local col4 decl" id="1924type" title='type' data-type='unsigned int' data-ref="1924type">type</dfn>, <b>struct</b> <a class="type" href="../net/net-msg.h.html#raw_message" title='raw_message' data-ref="raw_message">raw_message</a> *<dfn class="local col5 decl" id="1925raw" title='raw' data-type='struct raw_message *' data-ref="1925raw">raw</dfn>, <em>int</em> <dfn class="local col6 decl" id="1926dup" title='dup' data-type='int' data-ref="1926dup">dup</dfn>, <em>int</em> <dfn class="local col7 decl" id="1927payload_ints" title='payload_ints' data-type='int' data-ref="1927payload_ints">payload_ints</dfn>, <em>const</em> <em>unsigned</em> <em>int</em> *<dfn class="local col8 decl" id="1928payload" title='payload' data-type='const unsigned int *' data-ref="1928payload">payload</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="1929flags" title='flags' data-type='unsigned int' data-ref="1929flags">flags</dfn>, <em>void</em> (*<dfn class="local col0 decl" id="1930destructor" title='destructor' data-type='void (*)(struct job_message *)' data-ref="1930destructor">destructor</dfn>)(<b>struct</b> <a class="type" href="#job_message" title='job_message' data-ref="job_message">job_message</a> *<dfn class="local col1 decl" id="1931M" title='M' data-type='struct job_message *' data-ref="1931M">M</dfn>));</td></tr>
<tr><th id="370">370</th><td><i>//void job_message_send_data (JOB_REF_ARG (job), JOB_REF_ARG (src), unsigned int type, void *ptr1, void *ptr2, int int1, long long long1, int payload_ints, const unsigned int *payload, unsigned int flags);</i></td></tr>
<tr><th id="371">371</th><td><em>static</em> <b>inline</b> <em>void</em> <dfn class="decl def" id="job_message_send_empty" title='job_message_send_empty' data-ref="job_message_send_empty">job_message_send_empty</dfn> (<a class="macro" href="#46" title="int job_tag_int, job_t job" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col2 decl" id="1932job" title='job' data-type='job_t' data-ref="1932job">job</dfn>), <a class="macro" href="#46" title="int src_tag_int, job_t src" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col3 decl" id="1933src" title='src' data-type='job_t' data-ref="1933src">src</dfn>), <em>unsigned</em> <em>int</em> <dfn class="local col4 decl" id="1934type" title='type' data-type='unsigned int' data-ref="1934type">type</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="1935flags" title='flags' data-type='unsigned int' data-ref="1935flags">flags</dfn>) {</td></tr>
<tr><th id="372">372</th><td>  <a class="ref" href="#job_message_send" title='job_message_send' data-ref="job_message_send">job_message_send</a> (<a class="macro" href="#47" title="1, ({ typeof(job) __ptr_v_save = job; job = ((void*)0); __ptr_v_save; })" data-ref="_M/JOB_REF_PASS">JOB_REF_PASS</a> (<a class="local col2 ref" href="#371" title='job' data-ref="1932job">job</a>), <a class="macro" href="#47" title="1, ({ typeof(src) __ptr_v_save = src; src = ((void*)0); __ptr_v_save; })" data-ref="_M/JOB_REF_PASS">JOB_REF_PASS</a> (<a class="local col3 ref" href="#371" title='src' data-ref="1933src">src</a>), <a class="local col4 ref" href="#1934type" title='type' data-ref="1934type">type</a>, &amp;<a class="ref" href="../net/net-msg.h.html#empty_rwm" title='empty_rwm' data-ref="empty_rwm">empty_rwm</a>, <var>1</var>, <var>0</var>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <a class="local col5 ref" href="#1935flags" title='flags' data-ref="1935flags">flags</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="373">373</th><td>}</td></tr>
<tr><th id="374">374</th><td>    </td></tr>
<tr><th id="375">375</th><td><u>#define <dfn class="macro" id="_M/TL_TRUE" data-ref="_M/TL_TRUE">TL_TRUE</dfn> 0x3fedd339</u></td></tr>
<tr><th id="376">376</th><td><em>static</em> <b>inline</b> <em>int</em> <dfn class="decl def" id="job_message_answer_true" title='job_message_answer_true' data-ref="job_message_answer_true">job_message_answer_true</dfn> (<b>struct</b> <a class="type" href="#job_message" title='job_message' data-ref="job_message">job_message</a> *<dfn class="local col8 decl" id="1938M" title='M' data-type='struct job_message *' data-ref="1938M">M</dfn>) {    </td></tr>
<tr><th id="377">377</th><td>  <b>if</b> (<a class="local col8 ref" href="#1938M" title='M' data-ref="1938M">M</a>-&gt;<a class="ref" href="#job_message::src" title='job_message::src' data-ref="job_message::src">src</a>) {</td></tr>
<tr><th id="378">378</th><td>    <a class="ref" href="#job_message_send" title='job_message_send' data-ref="job_message_send">job_message_send</a> (<a class="macro" href="#47" title="1, ({ typeof(M-&gt;src) __ptr_v_save = M-&gt;src; M-&gt;src = ((void*)0); __ptr_v_save; })" data-ref="_M/JOB_REF_PASS">JOB_REF_PASS</a> (<a class="local col8 ref" href="#1938M" title='M' data-ref="1938M">M</a>-&gt;<a class="ref" href="#job_message::src" title='job_message::src' data-ref="job_message::src">src</a>), <a class="macro" href="#48" title="1, ((void*)0)" data-ref="_M/JOB_REF_NULL">JOB_REF_NULL</a>, <a class="macro" href="#375" title="0x3fedd339" data-ref="_M/TL_TRUE">TL_TRUE</a>, &amp;<a class="ref" href="../net/net-msg.h.html#empty_rwm" title='empty_rwm' data-ref="empty_rwm">empty_rwm</a>, <var>1</var>, <a class="local col8 ref" href="#1938M" title='M' data-ref="1938M">M</a>-&gt;<a class="ref" href="#job_message::payload_ints" title='job_message::payload_ints' data-ref="job_message::payload_ints">payload_ints</a>, <a class="local col8 ref" href="#1938M" title='M' data-ref="1938M">M</a>-&gt;<a class="ref" href="#job_message::payload" title='job_message::payload' data-ref="job_message::payload">payload</a>, <a class="macro" href="#162" title="(((M-&gt;flags) &gt;&gt; 8) &amp; 255)" data-ref="_M/JMC_EXTRACT_ANSWER">JMC_EXTRACT_ANSWER</a> (<a class="local col8 ref" href="#1938M" title='M' data-ref="1938M">M</a>-&gt;<a class="ref" href="#job_message::flags" title='job_message::flags' data-ref="job_message::flags">flags</a>), <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="379">379</th><td>  }</td></tr>
<tr><th id="380">380</th><td>  <b>return</b> <var>1</var>;</td></tr>
<tr><th id="381">381</th><td>}</td></tr>
<tr><th id="382">382</th><td></td></tr>
<tr><th id="383">383</th><td><em>static</em> <b>inline</b> <em>int</em> <dfn class="decl def" id="job_message_continuation" title='job_message_continuation' data-ref="job_message_continuation">job_message_continuation</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col0 decl" id="1940job" title='job' data-type='job_t' data-ref="1940job">job</dfn>, <b>struct</b> <a class="type" href="#job_message" title='job_message' data-ref="job_message">job_message</a> *<dfn class="local col1 decl" id="1941M" title='M' data-type='struct job_message *' data-ref="1941M">M</dfn>, <em>int</em> <dfn class="local col2 decl" id="1942payload_magic" title='payload_magic' data-type='int' data-ref="1942payload_magic">payload_magic</dfn>) {</td></tr>
<tr><th id="384">384</th><td>  <b>if</b> (<a class="local col1 ref" href="#1941M" title='M' data-ref="1941M">M</a>-&gt;<a class="ref" href="#job_message::payload_ints" title='job_message::payload_ints' data-ref="job_message::payload_ints">payload_ints</a> &gt;= <var>1</var>) {</td></tr>
<tr><th id="385">385</th><td>    <a class="macro" href="../../include/assert.h.html#88" title="((M-&gt;payload[0] == payload_magic) ? (void) (0) : __assert_fail (&quot;M-&gt;payload[0] == payload_magic&quot;, &quot;/home/parallels/MTProxy/./jobs/jobs.h&quot;, 385, __PRETTY_FUNCTION__))" data-ref="_M/assert">assert</a> (<a class="local col1 ref" href="#1941M" title='M' data-ref="1941M">M</a>-&gt;<a class="ref" href="#job_message::payload" title='job_message::payload' data-ref="job_message::payload">payload</a>[<var>0</var>] == <a class="local col2 ref" href="#1942payload_magic" title='payload_magic' data-ref="1942payload_magic">payload_magic</a>);</td></tr>
<tr><th id="386">386</th><td>    <a class="macro" href="../../include/assert.h.html#88" title="((M-&gt;payload_ints == 5) ? (void) (0) : __assert_fail (&quot;M-&gt;payload_ints == 5&quot;, &quot;/home/parallels/MTProxy/./jobs/jobs.h&quot;, 386, __PRETTY_FUNCTION__))" data-ref="_M/assert">assert</a> (<a class="local col1 ref" href="#1941M" title='M' data-ref="1941M">M</a>-&gt;<a class="ref" href="#job_message::payload_ints" title='job_message::payload_ints' data-ref="job_message::payload_ints">payload_ints</a> == <var>5</var>);</td></tr>
<tr><th id="387">387</th><td>    <em>int</em> (*<dfn class="local col3 decl" id="1943func" title='func' data-type='int (*)(job_t, struct job_message *, void *)' data-ref="1943func">func</dfn>)(<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a>, <b>struct</b> <a class="type" href="#job_message" title='job_message' data-ref="job_message">job_message</a> *, <em>void</em> *) = *(<em>void</em> **)(<a class="local col1 ref" href="#1941M" title='M' data-ref="1941M">M</a>-&gt;<a class="ref" href="#job_message::payload" title='job_message::payload' data-ref="job_message::payload">payload</a> + <var>1</var>);</td></tr>
<tr><th id="388">388</th><td>    <em>void</em> *<dfn class="local col4 decl" id="1944extra" title='extra' data-type='void *' data-ref="1944extra">extra</dfn> = *(<em>void</em> **)(<a class="local col1 ref" href="#1941M" title='M' data-ref="1941M">M</a>-&gt;<a class="ref" href="#job_message::payload" title='job_message::payload' data-ref="job_message::payload">payload</a> + <var>3</var>);</td></tr>
<tr><th id="389">389</th><td>    <a class="macro" href="../../include/assert.h.html#88" title="((func) ? (void) (0) : __assert_fail (&quot;func&quot;, &quot;/home/parallels/MTProxy/./jobs/jobs.h&quot;, 389, __PRETTY_FUNCTION__))" data-ref="_M/assert">assert</a> (<a class="local col3 ref" href="#1943func" title='func' data-ref="1943func">func</a>);</td></tr>
<tr><th id="390">390</th><td>    <b>return</b> <a class="local col3 ref" href="#1943func" title='func' data-ref="1943func">func</a> (<a class="local col0 ref" href="#1940job" title='job' data-ref="1940job">job</a>, <a class="local col1 ref" href="#1941M" title='M' data-ref="1941M">M</a>, <a class="local col4 ref" href="#1944extra" title='extra' data-ref="1944extra">extra</a>);</td></tr>
<tr><th id="391">391</th><td>  }</td></tr>
<tr><th id="392">392</th><td>  <b>return</b> <var>1</var>;</td></tr>
<tr><th id="393">393</th><td>}</td></tr>
<tr><th id="394">394</th><td></td></tr>
<tr><th id="395">395</th><td><em>void</em> <dfn class="decl" id="job_message_queue_free" title='job_message_queue_free' data-ref="job_message_queue_free">job_message_queue_free</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col5 decl" id="1945job" title='job' data-type='job_t' data-ref="1945job">job</dfn>);</td></tr>
<tr><th id="396">396</th><td><em>void</em> <dfn class="decl" id="job_message_queue_init" title='job_message_queue_init' data-ref="job_message_queue_init">job_message_queue_init</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col6 decl" id="1946job" title='job' data-type='job_t' data-ref="1946job">job</dfn>);</td></tr>
<tr><th id="397">397</th><td><em>void</em> <dfn class="decl" id="job_message_queue_work" title='job_message_queue_work' data-ref="job_message_queue_work">job_message_queue_work</dfn> (<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col7 decl" id="1947job" title='job' data-type='job_t' data-ref="1947job">job</dfn>, <em>int</em> (*<dfn class="local col8 decl" id="1948receive_message" title='receive_message' data-type='int (*)(job_t, struct job_message *, void *)' data-ref="1948receive_message">receive_message</dfn>)(<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="local col9 decl" id="1949job" title='job' data-type='job_t' data-ref="1949job">job</dfn>, <b>struct</b> <a class="type" href="#job_message" title='job_message' data-ref="job_message">job_message</a> *<dfn class="local col0 decl" id="1950M" title='M' data-type='struct job_message *' data-ref="1950M">M</dfn>, <em>void</em> *<dfn class="local col1 decl" id="1951extra" title='extra' data-type='void *' data-ref="1951extra">extra</dfn>), <em>void</em> *<dfn class="local col2 decl" id="1952extra" title='extra' data-type='void *' data-ref="1952extra">extra</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col3 decl" id="1953mask" title='mask' data-type='unsigned int' data-ref="1953mask">mask</dfn>);</td></tr>
<tr><th id="398">398</th><td></td></tr>
<tr><th id="399">399</th><td><em>int</em> <dfn class="decl" id="job_free" title='job_free' data-ref="job_free">job_free</dfn> (<a class="macro" href="#46" title="int job_tag_int, job_t job" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col4 decl" id="1954job" title='job' data-type='job_t' data-ref="1954job">job</dfn>));</td></tr>
<tr><th id="400">400</th><td><a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="decl" id="job_timer_alloc" title='job_timer_alloc' data-ref="job_timer_alloc">job_timer_alloc</dfn> (<em>int</em> <dfn class="local col5 decl" id="1955thread_class" title='thread_class' data-type='int' data-ref="1955thread_class">thread_class</dfn>, <em>double</em> (*<dfn class="local col6 decl" id="1956alarm" title='alarm' data-type='double (*)(void *)' data-ref="1956alarm">alarm</dfn>)(<em>void</em> *), <em>void</em> *<dfn class="local col7 decl" id="1957extra" title='extra' data-type='void *' data-ref="1957extra">extra</dfn>);</td></tr>
<tr><th id="401">401</th><td></td></tr>
<tr><th id="402">402</th><td><b>struct</b> <dfn class="type def" id="thread_callback" title='thread_callback' data-ref="thread_callback">thread_callback</dfn> {</td></tr>
<tr><th id="403">403</th><td>  <b>struct</b> <a class="type" href="#thread_callback" title='thread_callback' data-ref="thread_callback">thread_callback</a> *<dfn class="decl" id="thread_callback::next" title='thread_callback::next' data-ref="thread_callback::next">next</dfn>;</td></tr>
<tr><th id="404">404</th><td>  <em>void</em> (*<dfn class="decl" id="thread_callback::new_thread" title='thread_callback::new_thread' data-ref="thread_callback::new_thread">new_thread</dfn>)(<em>void</em>);</td></tr>
<tr><th id="405">405</th><td>};</td></tr>
<tr><th id="406">406</th><td></td></tr>
<tr><th id="407">407</th><td><em>void</em> <dfn class="decl" id="register_thread_callback" title='register_thread_callback' data-ref="register_thread_callback">register_thread_callback</dfn> (<b>struct</b> <a class="type" href="#thread_callback" title='thread_callback' data-ref="thread_callback">thread_callback</a> *<dfn class="local col8 decl" id="1958cb" title='cb' data-type='struct thread_callback *' data-ref="1958cb">cb</dfn>);</td></tr>
<tr><th id="408">408</th><td><a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="decl" id="alloc_timer_manager" title='alloc_timer_manager' data-ref="alloc_timer_manager">alloc_timer_manager</dfn> (<em>int</em> <dfn class="local col9 decl" id="1959thread_class" title='thread_class' data-type='int' data-ref="1959thread_class">thread_class</dfn>);</td></tr>
<tr><th id="409">409</th><td></td></tr>
<tr><th id="410">410</th><td><b>struct</b> <dfn class="type def" id="job_message_payload" title='job_message_payload' data-ref="job_message_payload">job_message_payload</dfn> {</td></tr>
<tr><th id="411">411</th><td>  <a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a> <dfn class="decl" id="job_message_payload::job" title='job_message_payload::job' data-ref="job_message_payload::job">job</dfn>;</td></tr>
<tr><th id="412">412</th><td>  <em>int</em> <dfn class="decl" id="job_message_payload::message_class" title='job_message_payload::message_class' data-ref="job_message_payload::message_class">message_class</dfn>;</td></tr>
<tr><th id="413">413</th><td>  <em>int</em> <dfn class="decl" id="job_message_payload::payload_ints" title='job_message_payload::payload_ints' data-ref="job_message_payload::payload_ints">payload_ints</dfn>;</td></tr>
<tr><th id="414">414</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl" id="job_message_payload::payload" title='job_message_payload::payload' data-ref="job_message_payload::payload">payload</dfn>[<var>0</var>];</td></tr>
<tr><th id="415">415</th><td>};</td></tr>
<tr><th id="416">416</th><td></td></tr>
<tr><th id="417">417</th><td><em>static</em> <b>inline</b> <b>struct</b> <a class="type" href="#job_message_payload" title='job_message_payload' data-ref="job_message_payload">job_message_payload</a> *<dfn class="decl def" id="job_message_payload_alloc" title='job_message_payload_alloc' data-ref="job_message_payload_alloc">job_message_payload_alloc</dfn> (<a class="macro" href="#46" title="int job_tag_int, job_t job" data-ref="_M/JOB_REF_ARG">JOB_REF_ARG</a> (<dfn class="local col0 decl" id="1960job" title='job' data-type='job_t' data-ref="1960job">job</dfn>), <em>int</em> <dfn class="local col1 decl" id="1961message_class" title='message_class' data-type='int' data-ref="1961message_class">message_class</dfn>, <em>int</em> <dfn class="local col2 decl" id="1962payload_ints" title='payload_ints' data-type='int' data-ref="1962payload_ints">payload_ints</dfn>, <em>unsigned</em> <em>int</em> *<dfn class="local col3 decl" id="1963payload" title='payload' data-type='unsigned int *' data-ref="1963payload">payload</dfn>) {</td></tr>
<tr><th id="418">418</th><td>  <b>struct</b> <a class="type" href="#job_message_payload" title='job_message_payload' data-ref="job_message_payload">job_message_payload</a> *<dfn class="local col4 decl" id="1964P" title='P' data-type='struct job_message_payload *' data-ref="1964P">P</dfn> = <a class="ref" href="../../include/stdlib.h.html#malloc" title='malloc' data-ref="malloc">malloc</a> (<b>sizeof</b> (*<a class="local col4 ref" href="#1964P" title='P' data-ref="1964P">P</a>) + <var>4</var> * <a class="local col2 ref" href="#1962payload_ints" title='payload_ints' data-ref="1962payload_ints">payload_ints</a>);</td></tr>
<tr><th id="419">419</th><td>  <a class="local col4 ref" href="#1964P" title='P' data-ref="1964P">P</a>-&gt;<a class="ref" href="#job_message_payload::message_class" title='job_message_payload::message_class' data-ref="job_message_payload::message_class">message_class</a> = <a class="local col1 ref" href="#1961message_class" title='message_class' data-ref="1961message_class">message_class</a>;</td></tr>
<tr><th id="420">420</th><td>  <a class="local col4 ref" href="#1964P" title='P' data-ref="1964P">P</a>-&gt;<a class="ref" href="#job_message_payload::payload_ints" title='job_message_payload::payload_ints' data-ref="job_message_payload::payload_ints">payload_ints</a> = <a class="local col2 ref" href="#1962payload_ints" title='payload_ints' data-ref="1962payload_ints">payload_ints</a>;</td></tr>
<tr><th id="421">421</th><td>  <a class="local col4 ref" href="#1964P" title='P' data-ref="1964P">P</a>-&gt;<a class="ref" href="#job_message_payload::job" title='job_message_payload::job' data-ref="job_message_payload::job">job</a> = <a class="macro" href="#43" title="({ typeof(job) __ptr_v_save = job; job = ((void*)0); __ptr_v_save; })" data-ref="_M/PTR_MOVE">PTR_MOVE</a> (<a class="local col0 ref" href="#417" title='job' data-ref="1960job">job</a>);</td></tr>
<tr><th id="422">422</th><td>  <a class="ref" href="../../include/string.h.html#memcpy" title='memcpy' data-ref="memcpy">memcpy</a> (<a class="local col4 ref" href="#1964P" title='P' data-ref="1964P">P</a>-&gt;<a class="ref" href="#job_message_payload::payload" title='job_message_payload::payload' data-ref="job_message_payload::payload">payload</a>, <a class="local col3 ref" href="#1963payload" title='payload' data-ref="1963payload">payload</a>, <var>4</var> * <a class="local col2 ref" href="#1962payload_ints" title='payload_ints' data-ref="1962payload_ints">payload_ints</a>);</td></tr>
<tr><th id="423">423</th><td>  <b>return</b> <a class="local col4 ref" href="#1964P" title='P' data-ref="1964P">P</a>;</td></tr>
<tr><th id="424">424</th><td>}</td></tr>
<tr><th id="425">425</th><td></td></tr>
<tr><th id="426">426</th><td><em>long</em> <em>long</em> <dfn class="decl" id="jobs_get_allocated_memoty" title='jobs_get_allocated_memoty' data-ref="jobs_get_allocated_memoty">jobs_get_allocated_memoty</dfn> (<em>void</em>);</td></tr>
<tr><th id="427">427</th><td></td></tr>
<tr><th id="428">428</th><td><em>unsigned</em> <em>int</em> *<dfn class="decl" id="payload_continuation_create" title='payload_continuation_create' data-ref="payload_continuation_create">payload_continuation_create</dfn> (<em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="1966magic" title='magic' data-type='unsigned int' data-ref="1966magic">magic</dfn>, <em>int</em> (*<dfn class="local col7 decl" id="1967func" title='func' data-type='int (*)(job_t, struct job_message *, void *)' data-ref="1967func">func</dfn>)(<a class="typedef" href="#job_t" title='job_t' data-type='struct async_job *' data-ref="job_t">job_t</a>, <b>struct</b> <a class="type" href="#job_message" title='job_message' data-ref="job_message">job_message</a> *, <em>void</em> *<dfn class="local col8 decl" id="1968extra" title='extra' data-type='void *' data-ref="1968extra">extra</dfn>), <em>void</em> *<dfn class="local col9 decl" id="1969extra" title='extra' data-type='void *' data-ref="1969extra">extra</dfn>);</td></tr>
<tr><th id="429">429</th><td><u>#define <dfn class="macro" id="_M/PAYLOAD_CONTINUATION" data-ref="_M/PAYLOAD_CONTINUATION">PAYLOAD_CONTINUATION</dfn>(_magic,_func,_extra) 5, payload_continuation_create (_magic, _func, _extra)</u></td></tr>
<tr><th id="430">430</th><td></td></tr>
<tr><th id="431">431</th><td><b>extern</b> <b>struct</b> <a class="type" href="#job_thread" title='job_thread' data-ref="job_thread">job_thread</a> <dfn class="decl" id="JobThreads" title='JobThreads' data-ref="JobThreads">JobThreads</dfn>[];</td></tr>
<tr><th id="432">432</th><td><u>#define <dfn class="macro" id="_M/CNCT2" data-ref="_M/CNCT2">CNCT2</dfn>(a,b) a ## b</u></td></tr>
<tr><th id="433">433</th><td><u>#define <dfn class="macro" id="_M/CNCT" data-ref="_M/CNCT">CNCT</dfn>(a,b) CNCT2(a,b)</u></td></tr>
<tr><th id="434">434</th><td></td></tr>
<tr><th id="435">435</th><td><u>#define <dfn class="macro" id="_M/MODULE_STAT_TYPE" data-ref="_M/MODULE_STAT_TYPE">MODULE_STAT_TYPE</dfn> struct CNCT(jobs_module_stat_,MODULE)</u></td></tr>
<tr><th id="436">436</th><td><u>#define <dfn class="macro" id="_M/MODULE_STR" data-ref="_M/MODULE_STR">MODULE_STR</dfn>(a) MODULE_STR2(a)</u></td></tr>
<tr><th id="437">437</th><td><u>#define <dfn class="macro" id="_M/MODULE_STR2" data-ref="_M/MODULE_STR2">MODULE_STR2</dfn>(a) #a</u></td></tr>
<tr><th id="438">438</th><td><u>#define <dfn class="macro" id="_M/MODULE_STAT_PREFIX_NAME" data-ref="_M/MODULE_STAT_PREFIX_NAME">MODULE_STAT_PREFIX_NAME</dfn> CNCT(jobs_module_state_prefix_,MODULE)</u></td></tr>
<tr><th id="439">439</th><td><u>#define <dfn class="macro" id="_M/MODULE_STAT_PREFIX" data-ref="_M/MODULE_STAT_PREFIX">MODULE_STAT_PREFIX</dfn> char *MODULE_STAT_PREFIX_NAME</u></td></tr>
<tr><th id="440">440</th><td></td></tr>
<tr><th id="441">441</th><td><u>#define <dfn class="macro" id="_M/MODULE_STAT" data-ref="_M/MODULE_STAT">MODULE_STAT</dfn> CNCT(jobs_module_stat_,MODULE)</u></td></tr>
<tr><th id="442">442</th><td><u>#define <dfn class="macro" id="_M/MODULE_STAT_ARR" data-ref="_M/MODULE_STAT_ARR">MODULE_STAT_ARR</dfn> CNCT(jobs_module_list_stat_,MODULE)</u></td></tr>
<tr><th id="443">443</th><td></td></tr>
<tr><th id="444">444</th><td><u>#define <dfn class="macro" id="_M/MODULE_STAT_FUNCTION" data-ref="_M/MODULE_STAT_FUNCTION">MODULE_STAT_FUNCTION</dfn> int CNCT(MODULE,_prepare_stat) (stats_buffer_t *sb) { \</u></td></tr>
<tr><th id="445">445</th><td><u>  sb_printf (sb, "&gt;&gt;&gt;&gt;&gt;&gt;%s&gt;&gt;&gt;&gt;&gt;&gt;\tstart\n", MODULE_STR(MODULE));</u></td></tr>
<tr><th id="446">446</th><td></td></tr>
<tr><th id="447">447</th><td></td></tr>
<tr><th id="448">448</th><td><u>#define <dfn class="macro" id="_M/MODULE_STAT_FUNCTION_END" data-ref="_M/MODULE_STAT_FUNCTION_END">MODULE_STAT_FUNCTION_END</dfn> \</u></td></tr>
<tr><th id="449">449</th><td><u>  sb_printf (sb, "&lt;&lt;&lt;&lt;&lt;&lt;%s&lt;&lt;&lt;&lt;&lt;&lt;\tend\n", MODULE_STR(MODULE)); \</u></td></tr>
<tr><th id="450">450</th><td><u>  return sb-&gt;pos; }</u> </td></tr>
<tr><th id="451">451</th><td></td></tr>
<tr><th id="452">452</th><td><u>#define <dfn class="macro" id="_M/MODULE_INIT" data-ref="_M/MODULE_INIT">MODULE_INIT</dfn> \</u></td></tr>
<tr><th id="453">453</th><td><u>  MODULE_STAT_TYPE *MODULE_STAT_ARR[MAX_JOB_THREADS]; \</u></td></tr>
<tr><th id="454">454</th><td><u>  __thread MODULE_STAT_TYPE *MODULE_STAT; \</u></td></tr>
<tr><th id="455">455</th><td><u>  MODULE_STAT_PREFIX; \</u></td></tr>
<tr><th id="456">456</th><td><u>                                          \</u></td></tr>
<tr><th id="457">457</th><td><u>  void CNCT(jobs_module_thread_init_,MODULE) (void) {\</u></td></tr>
<tr><th id="458">458</th><td><u>    int id = get_this_thread_id ();\</u></td></tr>
<tr><th id="459">459</th><td><u>    assert (id &gt;= 0 &amp;&amp; id &lt; MAX_JOB_THREADS);\</u></td></tr>
<tr><th id="460">460</th><td><u>    MODULE_STAT = MODULE_STAT_ARR[id] = calloc (sizeof (MODULE_STAT_TYPE), 1);\</u></td></tr>
<tr><th id="461">461</th><td><u>  } \</u></td></tr>
<tr><th id="462">462</th><td><u>  \</u></td></tr>
<tr><th id="463">463</th><td><u>  struct thread_callback CNCT(MODULE,_thread_callback) = { \</u></td></tr>
<tr><th id="464">464</th><td><u>    .new_thread = CNCT(jobs_module_thread_init_, MODULE), \</u></td></tr>
<tr><th id="465">465</th><td><u>    .next = NULL \</u></td></tr>
<tr><th id="466">466</th><td><u>  }; \</u></td></tr>
<tr><th id="467">467</th><td><u>  void CNCT(jobs_module_register_,MODULE) (void) __attribute__ ((constructor));\</u></td></tr>
<tr><th id="468">468</th><td><u>  void CNCT(jobs_module_register_,MODULE) (void) { \</u></td></tr>
<tr><th id="469">469</th><td><u>    register_thread_callback (&amp;CNCT(MODULE,_thread_callback)); \</u></td></tr>
<tr><th id="470">470</th><td><u>  }</u></td></tr>
<tr><th id="471">471</th><td></td></tr>
<tr><th id="472">472</th><td></td></tr>
</table><hr/><p id='footer'>
Generated while processing <a href='../common/common-stats.c.html'>MTProxy/common/common-stats.c</a><br/>Generated on <em>2018-Jun-02</em> from project MTProxy revision <em>842f343decf6c463bdecf1862e357c4a03e4bc97</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
